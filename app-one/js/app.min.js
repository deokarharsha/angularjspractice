/*! Juliet ONE 2018-05-14 */

function normalize(data){var parser="";for(var key in data)key.indexOf("date")>-1||key.indexOf("Dt")>-1?void 0==data[key]||""==data[key]?parser+=",":parser+=data[key].slice(6,10)+"/"+data[key].slice(3,5)+"/"+data[key].slice(0,2)+",":null==data[key]?parser+=",":parser+=String(data[key]).replace(/,/g,";")+",";return parser.replace(/,\s*$/,"")}function sleep(milliseconds){for(var start=(new Date).getTime(),i=0;i<1e7&&!((new Date).getTime()-start>milliseconds);i++);}function randomString(length){for(var chars="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",string_length=length,randomString="",i=0;i<string_length;i++){var rnum=Math.floor(Math.random()*chars.length);randomString+=chars.substring(rnum,rnum+1)}return randomString}function getCurrentDate(){var today=new Date,dd=today.getDate(),mm=today.getMonth()+1,yyyy=today.getFullYear();return dd<10&&(dd="0"+dd),mm<10&&(mm="0"+mm),today=dd+"/"+mm+"/"+yyyy}function getCurrentDateTime(){var today=new Date,dd=today.getDate(),mm=today.getMonth()+1,yyyy=today.getFullYear(),hh=today.getHours(),nn=today.getMinutes(),ss=today.getSeconds();return dd<10&&(dd="0"+dd),mm<10&&(mm="0"+mm),hh<10&&(hh="0"+hh),nn<10&&(nn="0"+nn),ss<10&&(ss="0"+ss),today=dd+"/"+mm+"/"+yyyy+" "+hh+":"+nn+":"+ss}!function(){"use strict";angular.module("DataService",[]),angular.module("Authentication",[]),angular.module("Admin",[]),angular.module("Home",[]),angular.module("Finance",[]),angular.module("Payroll",[]),angular.module("Distributor",[]),angular.module("GAPIService",[]),angular.module("ODMS",[]),angular.module("julietONE",["ngRoute","ngCookies","ngSanitize","ngCsv","angucomplete-alt","ngTagsInput","DataService","Authentication","Admin","Home","Finance","Payroll","Distributor","GAPIService","ODMS"]).config(["$routeProvider",function($routeProvider){$routeProvider.when("/authenticate",{controller:"AuthenticationController",templateUrl:"modules/authentication/views/authenticate.html"}).when("/login",{controller:"LoginController",templateUrl:"modules/authentication/views/login.html"}).when("/",{controller:"HomeController",templateUrl:"modules/home/views/home.html"}).otherwise({redirectTo:"/authenticate"})}]).run(["$rootScope","$location","$cookieStore","$http",function($rootScope,$location,$cookieStore,$http){$rootScope.POSTRequestURL="http://api.julietapparels.com/ReSTService.svc/POSTRequest",$rootScope.globals=$cookieStore.get("globals")||{},$rootScope.globals.currentUser,$rootScope.$on("$locationChangeStart",function(event,next,current){"/authenticate"===$location.path()||$rootScope.globals.authenticatedIP||$location.path("/authenticate"),$rootScope.globals.currentUser&&$location.path("/")})}]).directive("onReadFile",function($parse){return{restrict:"A",scope:!1,link:function(scope,element,attrs){var fn=$parse(attrs.onReadFile);element.on("change",function(onChangeEvent){var reader=new FileReader;reader.onload=function(onLoadEvent){scope.$apply(function(){fn(scope,{$fileContent:onLoadEvent.target.result})})},reader.readAsText((onChangeEvent.srcElement||onChangeEvent.target).files[0])})}}}),window.onbeforeunload=function(){return"You have attempted to leave this page. Are you sure?"}}(),function(){"use strict";angular.module("GAPIService").factory("GAPIServices",["$q","$rootScope","$http",function($q,$rootScope,$http){function ensureUploadFolderPresent(folderTitle){return gapi.client.drive.files.list({q:"mimeType = 'application/vnd.google-apps.folder' and trashed = false and title = '"+folderTitle+"'"}).then(function(files){return files.result.items[0]})}function insertFile(fileData,filename,parentId){var deferred=$q.defer(),boundary="-------314159265358979323846",delimiter="\r\n--"+boundary+"\r\n",reader=new FileReader;return reader.readAsBinaryString(fileData),reader.onload=function(e){var contentType=fileData.type||"application/octet-stream",metadata={title:filename,mimeType:contentType,parents:[{id:parentId}]},base64Data=btoa(reader.result),multipartRequestBody=delimiter+"Content-Type: application/json\r\n\r\n"+JSON.stringify(metadata)+delimiter+"Content-Type: "+contentType+"\r\nContent-Transfer-Encoding: base64\r\n\r\n"+base64Data+"\r\n---------314159265358979323846--";gapi.client.request({path:"/upload/drive/v2/files",method:"POST",params:{uploadType:"multipart"},headers:{"Content-Type":'multipart/mixed; boundary="'+boundary+'"'},body:multipartRequestBody}).then(function(file){deferred.resolve(file.result)},function(reason){deferred.reject(reason)})},deferred.promise}function waitForFileToBecomeActive(fileId){var deferred=$q.defer();return gapi.client.request({path:"/drive/v2/files/"+fileId,method:"GET"}).then(function(){deferred.resolve()},function(){setTimeout(function(){waitForFileToBecomeActive(fileId).then(function(){deferred.resolve()},function(reason){deferred.reject(reason)})},1e3)}),deferred.promise}function insertPermission(file){var deferred=$q.defer();return gapi.client.drive.permissions.insert({fileId:file.id,resource:{withLink:!0,role:"reader",type:"anyone"}}).then(function(file){deferred.resolve(file.result)},function(reason){deferred.reject(reason)}),deferred.promise}var service={},client_id="581440600032-33c3309ho23q67oh8f2ljpe8vifqg5op.apps.googleusercontent.com",scope=["https://www.googleapis.com/auth/drive.file"];return gapi.auth.init(function(){gapi.client.load("drive","v2").then(function(){var _old_gapiCallbacks=window.gapiCallbacks;window.gapiCallbacks=new function(){this.push=function(callback){setTimeout(callback,0)}},_old_gapiCallbacks.forEach(function(callback){window.gapiCallbacks.push(callback)})},function(error){console.error(error)})}),window.gapiCallbacks=[],service.login=function(){var deferred=$q.defer();return this.checkAuthNonImmediate().then(function(accessToken){deferred.resolve(accessToken)},function(){gapi.auth.authorize({client_id:client_id,scope:scope,immediate:!0},function(authResult){authResult&&!authResult.error?deferred.resolve(gapi.auth.getToken().access_token):deferred.reject(authResult)})}),deferred.promise},service.checkAuthNonImmediate=function(){var deferred=$q.defer();return gapi.auth.authorize({client_id:client_id,scope:scope,immediate:!1},function(authResult){authResult&&!authResult.error?deferred.resolve(gapi.auth.getToken().access_token):deferred.reject(authResult)}),deferred.promise},service.createFolder=function(folderName){var deferred=$q.defer();return gapi.client.request({path:"/drive/v2/files/",method:"POST",headers:{"Content-Type":"application/json"},body:{title:folderName,mimeType:"application/vnd.google-apps.folder"}}).then(function(file){deferred.resolve(file.result)},function(reason){deferred.reject(reason)}),deferred.promise},service.createSubFolder=function(folderName,parentID){var deferred=$q.defer();return gapi.client.request({path:"/drive/v2/files/",method:"POST",headers:{"Content-Type":"application/json"},body:{title:folderName,mimeType:"application/vnd.google-apps.folder",parents:[{id:parentID}]}}).then(function(file){deferred.resolve(file.result)},function(reason){deferred.reject(reason)}),deferred.promise},service.rename=function(fileId,newTitle,callback){var body={title:newTitle};gapi.client.drive.files.patch({fileId:fileId,resource:body}).then(function(response){callback(angular.fromJson(response))})},service.upload=function(fileData,filename,folderTitle){return ensureUploadFolderPresent(folderTitle).then(function(directory){return insertFile(fileData,filename,directory.id)}).then(function(file){return waitForFileToBecomeActive(file.id).then(function(){return insertPermission(file).then(function(){return file})})})},service.copy=function(originFileId,folderID,callback){var body={parents:[{id:folderID}]};gapi.client.drive.files.copy({fileId:originFileId,resource:body}).execute(function(resp){resp.error?alert("Error occured while copying file to drive"):(insertPermission(resp),service.deleteFile(originFileId),callback(angular.fromJson(resp)))})},service.deleteFile=function(fileId){var deferred=$q.defer();return gapi.client.drive.files.delete({fileId:fileId}).execute(function(resp){deferred.resolve(resp)}),deferred.promise},service}])}(),function(){"use strict";angular.module("DataService").factory("DataServices",["$http","$rootScope","$filter",function($http,$rootScope,$filter){var service={};return service.Submit=function(requestName,data,callback){var result={};$http.post($rootScope.POSTRequestURL,{requestName:$rootScope.globals.currentDB.dbName+".dbo."+requestName,values:normalize(data)}).then(function(response){var resp=angular.fromJson(response.data);1==resp.length&&"Error"==angular.fromJson(response.data)[0].Response?result={error:angular.fromJson(response.data)[0].Error}:(result={success:"true"},"object"!==resp[0]&&(result.data=resp[0])),callback(result)},function(response){callback(result={error:"Something is went wrong."})})},service.Edit=function(tableName,id,callback){$http.post($rootScope.POSTRequestURL,{requestName:$rootScope.globals.currentDB.dbName+".dbo.getEditData",values:tableName+","+id}).then(function(response){callback(angular.fromJson(response.data)[0])})},service.SelectData=function(tableName,sortOrder,callback){$http.post($rootScope.POSTRequestURL,{requestName:$rootScope.globals.currentDB.dbName+".dbo.getSelectData",values:tableName+","+sortOrder}).then(function(response){callback(angular.fromJson(response.data))})},service.getData=function(requestName,parameters,callback){$http.post($rootScope.POSTRequestURL,{requestName:$rootScope.globals.currentDB.dbName+".dbo."+requestName,values:normalize(parameters)}).then(function(response){callback(angular.fromJson(response.data))})},service}]).filter("unique",function(){return function(collection,keyname){var output=[],keys=[];return angular.forEach(collection,function(item){var key=item[keyname];-1===keys.indexOf(key)&&(keys.push(key),output.push(item))}),output}}).filter("Count",function(){return function(data,key){if(void 0===data||void 0===key)return 0;for(var count=0,i=data.length-1;i>=0;i--)count+=1;return count}}).filter("Sum",function(){return function(data,key){if(void 0===data||void 0===key)return 0;for(var sum=0,i=data.length-1;i>=0;i--)sum+=parseInt(data[i][key]);return sum}})}(),function(){"use strict";angular.module("Admin").controller("AppsCtrl",["DataServices","$scope",function(DataServices,$scope){$scope.data={},$scope.data.ID=0,$scope.submit=function(){DataServices.Submit("doApps",$scope.data,function(response){$scope.result=response})},$scope.edit=function(id){$scope.result={},DataServices.Edit("Apps",id,function(data){$scope.data=data})},$scope.reset=function(){$scope.data={},$scope.data.ID=0}}]).controller("DBsCtrl",["DataServices","$scope","$filter",function(DataServices,$scope,$filter){$scope.data={ID:0,appID:0,name:"",dbName:"",hasDivisions:0},DataServices.SelectData("Apps","name",function(response){$scope.apps=response,$scope.selectedApp=$scope.apps[0]}),$scope.selectApp=function(selectedApp){$scope.data.appID=selectedApp.id},$scope.submit=function(){DataServices.Submit("doDBConfig",$scope.data,function(response){$scope.result=response})},$scope.edit=function(id){$scope.result="",DataServices.Edit("DBConfig",id,function(response){$scope.data=response,$scope.selectedApp=$filter("filter")($scope.apps,{id:$scope.data.appID})[0]})},$scope.reset=function(){$scope.data={ID:0,appID:0,name:"",dbName:"",hasDivisions:0},$scope.selectedApp=$scope.apps[0]}}]).controller("DbAccessCtrl",["DataServices","$scope",function(DataServices,$scope){function getAccessData(id){var para={ID:id,tblName:"DBAccess"};DataServices.getData("getAccessData",para,function(response){$scope.databases=response})}DataServices.SelectData("Users","userName",function(response){$scope.users=response,$scope.selectedUser=function(selected){selected&&($scope.selectedUser.id=selected.originalObject.id,getAccessData(selected.originalObject.id))}}),$scope.checked=function(data){var para={userID:$scope.selectedUser.id,dbID:data.dbID,canAccess:data.canAccess};DataServices.Submit("doDBAccess",para,function(response){$scope.result=response})},$scope.reset=function(){$scope.$broadcast("angucomplete-alt:clearInput","Users"),$scope.databases=[]}}]).controller("ModulesCtrl",["DataServices","$scope","$filter",function(DataServices,$scope,$filter){$scope.data={ID:0,appID:0,parentID:0,name:"",action:"",icon:"",sortID:0,tblName:"",para:""},DataServices.SelectData("Apps","name",function(response){$scope.apps=response,$scope.selectedApp=$scope.apps[0],$scope.selectApp=function(selectedApp){$scope.data.appID=selectedApp.id}}),$scope.parents=[{id:"0",name:"(Select)"},{id:"1",name:"Main"},{id:"2",name:"Transactions"},{id:"3",name:"Reports"},{id:"4",name:"Utility"},{id:"5",name:"Settings"}],$scope.selectedParent=$scope.parents[0],$scope.selectParent=function(selectedParent){$scope.data.parentID=selectedParent.id},$scope.submit=function(){DataServices.Submit("doModules",$scope.data,function(response){$scope.result=response})},$scope.edit=function(id){DataServices.Edit("Modules",id,function(response){$scope.data=response,$scope.selectedApp=$filter("filter")($scope.apps,{id:$scope.data.appID})[0],$scope.selectedParent=$filter("filter")($scope.parents,{id:$scope.data.parentID})[0]})},$scope.reset=function(){$scope.data={ID:0,appID:0,parentID:0,name:"",action:"",icon:"",sortID:0,tblName:"",para:""},$scope.selectedApp=$scope.apps[0],$scope.selectedParent=$scope.parents[0]}}]).controller("ModAccessCtrl",["DataServices","$scope",function(DataServices,$scope){function initialise(){$scope.users={},$scope.modules=[],$scope.selectedApp={},$scope.$broadcast("angucomplete-alt:clearInput","Users"),loadUsernames(),$scope.canAddAll=!1,$scope.canEditAll=!1,$scope.canDeleteAll=!1,$scope.canAccessAll=!1}function loadUsernames(){DataServices.SelectData("Users","userName",function(response){$scope.users=response,$scope.selectedUser=function(selected){selected&&($scope.selectedUser.id=selected.originalObject.id,getAccessData($scope.selectedUser.id))}})}function getAccessData(id){var para={ID:id,tblName:"ModuleAccess"};DataServices.getData("getAccessData",para,function(response){$scope.modules=response;for(var i=0;i<$scope.modules.length;i++)1==$scope.modules[i].canAdd&&($scope.canAddAll=!0),1==$scope.modules[i].canEdit&&($scope.canEditAll=!0),1==$scope.modules[i].canDelete&&($scope.canDeleteAll=!0),1==$scope.modules[i].canAccess&&($scope.canAccessAll=!0)})}initialise(),$scope.parents=[{id:"0",name:"(All)"},{id:"1",name:"Main"},{id:"2",name:"Transactions"},{id:"3",name:"Reports"},{id:"4",name:"Settings"}],$scope.selectedParent=$scope.parents[0],$scope.selectParent=function(selectedParent){$scope.parentID=selectedParent.id},$scope.checked=function(data){var para={ID:data.modID,userID:$scope.selectedUser.id,canAdd:data.canAdd,canEdit:data.canEdit,canDelete:data.canDelete,canAccess:data.canAccess,appID:data.appID,parentID:data.parentID};DataServices.Submit("doModuleAccess",para,function(response){$scope.result=response})},$scope.checkAll=function(){for(var appID="",parentID="",i=0;i<$scope.modules.length;i++){$scope.modules[i].canAdd=$scope.canAddAll,$scope.modules[i].canEdit=$scope.canEditAll,$scope.modules[i].canDelete=$scope.canDeleteAll,$scope.modules[i].canAccess=$scope.canAccessAll,void 0==$scope.selectedApp.appName&&void 0==$scope.parentID?(appID="%",parentID="%"):(appID=$scope.selectedApp.appID,parentID=$scope.parentID);var para={ID:0,userID:$scope.selectedUser.id,canAdd:$scope.modules[i].canAdd,canEdit:$scope.modules[i].canEdit,canDelete:$scope.modules[i].canDelete,canAccess:$scope.modules[i].canAccess,appID:appID,parentID:parentID}}DataServices.Submit("doModuleAccess",para,function(response){$scope.result=response})},$scope.reset=function(){initialise()}}]).controller("UserCtrl",["DataServices","$scope",function(DataServices,$scope){$scope.data={ID:0,userName:"",displayName:"",password:"",userType:"",isActive:1},$scope.submit=function(){DataServices.Submit("doUsers",$scope.data,function(response){$scope.result=response})},$scope.edit=function(id){$scope.result={},DataServices.Edit("Users",id,function(response){$scope.data=response,$scope.data.password=""})},$scope.reset=function(){$scope.data={ID:0,userName:"",displayName:"",password:"",userType:"",isActive:1},$scope.confirmPassword=""}}]).controller("IpWhitelistCtrl",["DataServices","$scope",function(DataServices,$scope){$scope.data={ID:0,ipAddress:"",desc:""},$scope.submit=function(){DataServices.Submit("doIP",$scope.data,function(response){$scope.result=response})},$scope.edit=function(id){$scope.result={},DataServices.Edit("IPTable",id,function(response){$scope.data=response})},$scope.reset=function(){$scope.data={ID:0,ipAddress:"",desc:""}}}])}(),function(){"use strict";angular.module("Authentication").controller("AuthenticationController",["$cookieStore","$rootScope","$http","$location","$scope",function($cookieStore,$rootScope,$http,$location,$scope){document.getElementById("login").style.display="none",setTimeout(function(){window.onresize=function(){$(window).width();var vph=$(window).height();document.getElementById("main-div").style.height=vph+"px"}},1),$http.get("https://api.ipify.org/").then(function(ip){$http.post($rootScope.POSTRequestURL,{requestName:"authenticateIP",values:ip.data}).then(function(response){1==angular.fromJson(response.data)[0].result?($rootScope.globals.authenticatedIP=!0,$cookieStore.put("ip",ip.data),$location.path("/login")):($rootScope.globals.authenticatedIP=!1,document.getElementById("main-div").style.display="none",document.getElementById("login").style.display="block")})}),$scope.login=function(){$scope.error="User name or password not matched."}}]).controller("LoginController",["AuthenticationService","$location","$http","$rootScope","$scope",function(AuthenticationService,$location,$http,$rootScope,$scope){AuthenticationService.ClearCredentials(),$scope.login=function(){AuthenticationService.Login($scope.username,$scope.password,function(response){console.log($rootScope.globals),response.success&&$location.path("/")})}}])}(),function(){"use strict";angular.module("Authentication").factory("AuthenticationService",["Base64","$http","$cookieStore","$rootScope",function(Base64,$http,$cookieStore,$rootScope){var service={};return service.Login=function(username,password,callback){var result={};$http.post($rootScope.POSTRequestURL,{requestName:"AuthorizeUser",values:username+","+password}).then(function(response){"Success!"===angular.fromJson(response.data)[0].Response?(result={success:angular.fromJson(response.data)[0].Response},service.SetCredentials(angular.fromJson(response.data,password))):result.message="Username or password is incorrect.",callback(result)},function(error){result.message=JSON.stringify(error),callback(result)})},service.SetCredentials=function(responseData,password){var authdata=Base64.encode(responseData[0].name+password);$rootScope.globals={currentUser:{authdata:authdata,ID:responseData[0].ID,name:responseData[0].name,displayName:responseData[0].displayName,type:responseData[0].userType,token:responseData[0].token,ip:$cookieStore.get("ip")},currentDB:{},currentCompany:{name:"Juliet Apparels Ltd."}},$cookieStore.put("globals",$rootScope.globals)},service.ClearCredentials=function(){$rootScope.globals={},$cookieStore.remove("globals")},service}]).factory("Base64",function(){var keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";return{encode:function(input){var chr1,chr2,enc1,enc2,enc3,output="",chr3="",enc4="",i=0;do{enc1=(chr1=input.charCodeAt(i++))>>2,enc2=(3&chr1)<<4|(chr2=input.charCodeAt(i++))>>4,enc3=(15&chr2)<<2|(chr3=input.charCodeAt(i++))>>6,enc4=63&chr3,isNaN(chr2)?enc3=enc4=64:isNaN(chr3)&&(enc4=64),output=output+keyStr.charAt(enc1)+keyStr.charAt(enc2)+keyStr.charAt(enc3)+keyStr.charAt(enc4),chr1=chr2=chr3="",enc1=enc2=enc3=enc4=""}while(i<input.length);return output},decode:function(input){var chr1,chr2,enc2,enc3,output="",chr3="",enc4="",i=0;/[^A-Za-z0-9\+\/\=]/g.exec(input)&&window.alert("There were invalid base64 characters in the input text.\nValid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='\nExpect errors in decoding."),input=input.replace(/[^A-Za-z0-9\+\/\=]/g,"");do{chr1=keyStr.indexOf(input.charAt(i++))<<2|(enc2=keyStr.indexOf(input.charAt(i++)))>>4,chr2=(15&enc2)<<4|(enc3=keyStr.indexOf(input.charAt(i++)))>>2,chr3=(3&enc3)<<6|(enc4=keyStr.indexOf(input.charAt(i++))),output+=String.fromCharCode(chr1),64!=enc3&&(output+=String.fromCharCode(chr2)),64!=enc4&&(output+=String.fromCharCode(chr3)),chr1=chr2=chr3="",enc2=enc3=enc4=""}while(i<input.length);return output}}})}(),function(){"use strict";angular.module("Finance").controller("GSTCompareCtrl",["DataServices","$scope","$filter",function(DataServices,$scope,$filter){$scope.result={},$scope.gstData={},$scope.b2bData={},$scope.browse=function(){document.getElementById("uploadFile").click()},$scope.showContent=function($fileContent){$scope.gstData=angular.fromJson($fileContent),angular.forEach($scope.gstData,function(value,key){}),$scope.b2bData=Object.keys($scope.gstData)}}])}(),function(){"use strict";angular.module("Home").controller("HomeController",function(){}).controller("dashboardCtrl",["$location","$cookieStore","$http","$rootScope","$scope","$filter",function($location,$cookieStore,$http,$rootScope,$scope,$filter){function loadTickets(){$scope.data={email:$rootScope.globals.currentUser.name,userType:$rootScope.globals.currentUser.type},$http.post($rootScope.POSTRequestURL,{requestName:"jildb.dbo.getTickets",values:normalize($scope.data)}).then(function(response){var resp=angular.fromJson(response.data);1==resp.length&&"Error"==response.Response?$scope.result={error:response.Error}:"object"==typeof resp&&($scope.tickets=resp)},function(response){$scope.result={error:"Something is went wrong."}})}$scope.$on("refreshDahsboard",function(){loadTickets()}),$scope.toggleContainer=function(flag){$scope.showNewTicketContainer=flag},$scope.chngePwd=function(){$scope.modalResult={},$http.post($rootScope.POSTRequestURL,{requestName:"doUsers",values:$rootScope.globals.currentUser.ID+","+$rootScope.globals.currentUser.name+","+$rootScope.globals.currentUser.displayName+","+$scope.password+","+$rootScope.globals.currentUser.type+",1"}).then(function(response){$scope.modalResult.success=!0},function(error){$scope.modalResult.error=!0})},$scope.resetPwdForm=function(){$scope.password="",$scope.confirmPassword="",$scope.modalResult={}},$scope.signOut=function(){confirm("Confirm Sign out?")&&AuthenticationService.LoginInfo("Delete",function(response){$rootScope.globals={},$cookieStore.remove("globals"),alert("User logged out successfully!"),$location.path("/authenticate")})},$scope.tickets=[{}],$scope.currentDt=getCurrentDate(),loadTickets(),$scope.callAction=function(id,action){var resolution=prompt("Resolution","#"+action);if(null!==resolution){var para={command:action,ID:id,ticketID:"",ticketdt:"",custID:"",name:$rootScope.globals.currentUser.displayName,email:$rootScope.globals.currentUser.name,prodID:"",issueType:"",issue:"",resolution:resolution,ip:""};$http.post($rootScope.POSTRequestURL,{requestName:"jildb.dbo.doTickets",values:normalize(para)}).then(function(response){loadTickets()},function(response){$scope.result={error:"Something is went wrong."}})}},$scope.checkClosedTickets=function(){return $filter("filter")($scope.tickets,{action:"close"}).length}}]).controller("NavController",function($scope){$scope.isCollapsed=!0,$scope.$on("$routeChangeSuccess",function(){$scope.isCollapsed=!0})}).directive("sideNav",function(){return{restrict:"E",templateUrl:"modules/home/views/side-nav.html",link:function(){setTimeout(function(){$(window).width();var vph=$(window).height();document.getElementById("side-menu").style.height=vph+"px",window.onresize=function(){$(window).width();var vph=$(window).height();document.getElementById("side-menu").style.height=vph+"px"},$("#side-menu").metisMenu()},1)},controller:function($http,$rootScope,$scope){$scope.navItems=[],$http.post($rootScope.POSTRequestURL,{requestName:"getDBs",values:$rootScope.globals.currentUser.ID}).then(function(dbData){$scope.DBs=angular.fromJson(dbData.data)},function(error){console.error(error)}),$scope.selectDB=function(selectedDB){if(null===selectedDB)$rootScope.globals.currentDB={},$scope.navItems=[],$scope.divisions={};else{$rootScope.globals.currentDB={appID:selectedDB.appID,name:selectedDB.name,dbName:selectedDB.dbName,hasDivisions:selectedDB.hasDivisions},1==selectedDB.hasDivisions?($scope.navItems=[],$http.post($rootScope.POSTRequestURL,{requestName:selectedDB.dbName+".dbo.getDivisions",values:$rootScope.globals.currentUser.ID}).then(function(divData){$scope.divisions=angular.fromJson(divData.data),$scope.selectDivision=function(selectedDivision){selectedDivision?($rootScope.globals.currentDivision={ID:selectedDivision.ID,name:selectedDivision.name},loadMenus()):$scope.navItems=[]}})):($scope.divisions={},loadMenus()),$scope.selectedIndex=0,$scope.selectMenu=function(menu){$scope.selectedIndex=menu.id},$scope.isSelected=function(menu){return $scope.selectedIndex===menu.id};function loadMenus(){$http.post($rootScope.POSTRequestURL,{requestName:"getModules",values:$rootScope.globals.currentDB.appID+","+$rootScope.globals.currentUser.ID}).then(function(menuData){$scope.navItems=angular.fromJson(menuData.data)},function(error){console.error(error)})}}}},controllerAs:"side-nav"}}).directive("tabs",function($filter){return{restrict:"E",templateUrl:"modules/home/views/tabs.html",controller:function($scope){var tabs=[];$scope.tabs=tabs,$scope.selectedIndex=0,$scope.selectTab=function(tab){$scope.tabs.previous=$scope.tabs.selected,$scope.tabs.selected=tab.id,$scope.selectedIndex=tab.id},$scope.isSelected=function(tab){return $scope.selectedIndex===tab.id},$scope.addTab=function(tab){-1==tabs.indexOf(tab)&&$scope.tabs.push(tab)},$scope.removeTab=function(tab){var index=$scope.tabs.indexOf(tab);$scope.tabs.splice(index,1),tab.id==$scope.tabs.selected&&($scope.selectedIndex=$scope.tabs.previous),"[]"==angular.toJson($filter("filter")($scope.tabs,{id:$scope.tabs.previous}))&&($scope.selectedIndex=Math.max.apply(Math,$scope.tabs.map(function(o){return o.id})))}},controllerAs:"tabsCtrl"}}).directive("contents",function($filter){return{restrict:"E",templateUrl:"modules/home/views/contents.html",transclude:!0,controller:function($rootScope,$scope,$http){var contents=[];$scope.contents=contents,$scope.selectedIndex=0,$scope.selectContent=function(content){$scope.contents.previous=$scope.contents.selected,$scope.contents.selected=content.id,$scope.selectedIndex=content.id,$rootScope.currentModuleId=$scope.contents.indexOf(content),$rootScope.currentModule=content.name},$scope.isSelected=function(content){return $scope.selectedIndex===content.id},$scope.addContent=function(content){-1==contents.indexOf(content)&&$scope.contents.push(content)},$scope.removeContent=function(content){var index=$scope.contents.indexOf(content);$scope.contents.splice(index,1),content.id==$scope.contents.selected&&($scope.selectedIndex=$scope.contents.previous),"[]"==angular.toJson($filter("filter")($scope.contents,{id:$scope.contents.previous}))&&($scope.selectedIndex=Math.max.apply(Math,$scope.contents.map(function(o){return o.id})))},$scope.search=function(searchStr){$scope.dataLoading=!0,$scope.setViewMode(!0),void 0===searchStr&&(searchStr="%"),$http.post($rootScope.POSTRequestURL,{requestName:$rootScope.globals.currentDB.dbName+".dbo.getSearchData",values:$scope.contents[$rootScope.currentModuleId].tblName+","+searchStr}).then(function(data){$scope.contents[$rootScope.currentModuleId].viewData=angular.fromJson(data.data),$scope.colHeaders=Object.keys($scope.contents[$rootScope.currentModuleId].viewData[0])},function(error){$scope.error=JSON.stringify(error)}),$scope.dataLoading=!1,$scope.loading=""},$scope.setViewMode=function(value){$scope.contents[$rootScope.currentModuleId].viewMode=value},$scope.setHelpScreen=function(value){$scope.hideShowHelpScreen=value}},controllerAs:"contentsCtrl"}}).directive("editTable",function(){return{restrict:"E",template:'<table class="table table-responsive table-striped table-bordered"><thead><tr><th></th><th ng-repeat="header in colHeaders" ng-hide="header.indexOf(\'ID\') > -1">{{ header }}</th></tr></thead><tbody><tr ng-repeat="content in content.viewData"><td ng-hide="content.Error.length" width="30px"><a href="#/" ng-click="edit(content.ID); setViewMode(false)"><i class="fa fa-pencil"></i></a></td><td ng-repeat="key in colHeaders" ng-hide="key.indexOf(\'ID\') > -1">{{ content[key] }}</td></tr></tbody></table><input ng-click="reset(); setViewMode(false)" type="button" class="btn btn-primary" value="Add New">'}}).directive("ieButton",function(){return{restrict:"E",template:'<input type="button value="text">"'}}).controller("ticketSupportCtrl",["$http","$rootScope","$scope",function($http,$rootScope,$scope){$scope.data={command:"add",ID:0,ticketID:"TS"+randomString(6),ticketDt:getCurrentDateTime(),custID:0,name:$rootScope.globals.currentUser.displayName,email:$rootScope.globals.currentUser.name,prodID:0,issueType:"",issue:"",resolution:"",ip:$rootScope.globals.currentUser.ip},$scope.issueTypes=[{id:0,name:"(Select)"},{id:1,name:"New Development"},{id:2,name:"Update Request"},{id:3,name:"Error"},{id:4,name:"Support"},{id:5,name:"Query"},{id:6,name:"Enhancement"}],$scope.selectedIssueType=$scope.issueTypes[0],$scope.selectIssueType=function(selectedIssueType){$scope.data.issueType=selectedIssueType.name},$scope.companies=[{id:0,name:"(Select)"},{id:8,name:"JAL"},{id:9,name:"JIL"},{id:44,name:"BSLLP"}],$scope.selectedCompany=$scope.companies[0],$scope.selectCompany=function(selectedCompany){$scope.data.custID=selectedCompany.id},$scope.products=[{id:0,name:"(Select)"},{id:42,name:"FIN - JAL"},{id:43,name:"FIN - JIL"},{id:44,name:"DST - Juliet"},{id:45,name:"DST - Sphere"},{id:46,name:"DST - Shades"},{id:47,name:"DST - Soulmate"},{id:48,name:"DST - Saffaran"},{id:49,name:"DST - Elastic"},{id:50,name:"DST - Embroidery"},{id:51,name:"MFG - Juliet"},{id:52,name:"MFG - Sphere"},{id:53,name:"MFG - JIL"},{id:54,name:"PAY - JAL"},{id:55,name:"PAY - JIL"},{id:56,name:"PAY - JAL C"},{id:57,name:"PAY - JAL Bhiwandi"},{id:58,name:"BSLLP"},{id:59,name:"Delhi"},{id:60,name:"Gujarat"},{id:61,name:"Hyderabad"},{id:62,name:"Bengaluru"}],$scope.selectedProduct=$scope.products[0],$scope.selectProduct=function(selectedProduct){$scope.data.prodID=selectedProduct.id},$scope.submit=function(){$scope.result={},$http.post($rootScope.POSTRequestURL,{requestName:"jildb.dbo.doTickets",values:normalize($scope.data)}).then(function(response){var resp=response.data;1==resp.length&&"Error"==response.Response?$scope.result={error:response.Error}:($scope.result={success:"true"},"object"==typeof resp&&($scope.data.ticketID=angular.fromJson(resp.data)[0].ticketID))},function(response){$scope.result={error:"Something is went wrong."}}),$rootScope.$broadcast("refreshDahsboard",{})},$scope.reset=function(){$scope.result={},$scope.data={command:"add",ID:0,ticketID:"TS"+randomString(6),ticketDt:getCurrentDateTime(),custID:0,name:$rootScope.globals.currentUser.displayName,email:$rootScope.globals.currentUser.name,prodID:0,issueType:"",issue:"",resolution:"",ip:$rootScope.globals.currentUser.ip},$scope.selectedIssueType=$scope.issueTypes[0],$scope.selectedCompany=$scope.companies[0],$scope.selectedProduct=$scope.products[0]}}])}(),function(){"use strict";angular.module("ODMS").controller("FoldersCtrl",["GAPIServices","DataServices","$rootScope","$scope",function(GAPIServices,DataServices,$rootScope,$scope){$scope.data={ID:0,name:"",desc:"",parentID:"",folderID:"",fieldList:""},$scope.result={},$scope.submit=function(){GAPIServices.login().then(function(){0==$scope.data.ID?($scope.data={action:"add",ID:$scope.data.ID,name:$scope.data.name,desc:$scope.data.desc,parentID:0,folderID:randomString(8),fieldList:$scope.data.fieldList},DataServices.Submit("doFolders",$scope.data,function(response){$scope.result.notify="Saving record ...",$scope.newID=response.data.ID,void 0!=response.success?GAPIServices.createFolder($scope.data.name).then(function(gapiResponse){$scope.result.notify="Creating folder ...",void 0!=gapiResponse.id?($scope.data={action:"update",ID:$scope.newID,name:$scope.data.name,desc:$scope.data.desc,parentID:0,folderID:gapiResponse.id,fieldList:$scope.data.fieldList},DataServices.Submit("doFolders",$scope.data,function(response){$scope.result=response})):$scope.result.error="Error while creating folder in drive."}):$scope.result=response})):($scope.data={action:"update",ID:$scope.data.ID,name:$scope.data.name,abbr:$scope.data.desc,parentID:0,folderID:$scope.data.folderID,fieldList:$scope.data.fieldList},DataServices.Submit("doFolders",$scope.data,function(response){void 0!==response.success?(GAPIServices.rename($scope.data.folderID,$scope.data.name,function(resp){}),$scope.result=response):$scope.result=response}))})},$scope.edit=function(id){$scope.result={},DataServices.Edit("Folders",id,function(response){$scope.data=response})},$scope.reset=function(){$scope.data={ID:0,name:"",desc:"",folderID:"",fieldList:""}}}]).controller("SubFoldersCtrl",["GAPIServices","DataServices","$rootScope","$scope","$filter",function(GAPIServices,DataServices,$rootScope,$scope,$filter){function getFeildListsValues(){for(var values="",i=0;i<$scope.fieldListJson.length;i++)values+=$scope.fieldListJson[i].fieldValue+";";return values.replace(/;\s*$/,"")}$scope.data={ID:0,name:"",desc:"",parentID:0,folderID:"",fieldList:""},$scope.result={},$scope.fieldListJson=[],DataServices.SelectData("Folders","name",function(response){$scope.folders=response,$scope.selectedFolder=$scope.folders[0]}),$scope.selectFolder=function(selectedFolder){$scope.data.parentID=selectedFolder.id,$scope.data.desc=selectedFolder.desc,$scope.parentFolderID=selectedFolder.folderID,$scope.fieldListJson=[],selectedFolder.fieldList&&angular.forEach(selectedFolder.fieldList.split("#"),function(value,key){$scope.fieldListJson.push({fieldName:value,fieldValue:""})})},$scope.submit=function(){$scope.data.fieldList=getFeildListsValues(),GAPIServices.login().then(function(){0==$scope.data.ID?($scope.data={action:"add",ID:$scope.data.ID,name:$scope.data.name,desc:$scope.data.desc,parentID:$scope.data.parentID,folderID:randomString(8),fieldList:$scope.data.fieldList},DataServices.Submit("doFolders",$scope.data,function(response){$scope.result.notify="Saving record...",$scope.newID=response.data.ID,void 0!=response.success?GAPIServices.createSubFolder($scope.data.name,$scope.parentFolderID).then(function(gapiResponse){if($scope.result.notify="Creating folder...",void 0!=gapiResponse.id){var para={action:"update",ID:$scope.newID,name:$scope.data.name,desc:$scope.data.desc,parentID:$scope.data.parentID,folderID:gapiResponse.id,fieldList:$scope.data.fieldList};DataServices.Submit("doFolders",para,function(response){$scope.result=response})}else $scope.result.error="Error while creating folder"}):$scope.result=response})):($scope.data={action:"update",ID:$scope.data.ID,name:$scope.data.name,desc:$scope.data.desc,parentID:$scope.data.parentID,folderID:$scope.data.folderID,fieldList:$scope.data.fieldList},DataServices.Submit("doFolders",$scope.data,function(response){void 0!=response.success?8==$scope.data.folderID.length?GAPIServices.createSubFolder($scope.data.name,$scope.parentFolderID).then(function(gapiResponse){if($scope.result.notify="Creating folder...",void 0!=gapiResponse.id){var para={action:"update",ID:$scope.data.ID,name:$scope.data.name,desc:$scope.data.desc,parentID:$scope.data.parentID,folderID:gapiResponse.id,fieldList:$scope.data.fieldList};DataServices.Submit("doFolders",para,function(response){$scope.result=response})}else $scope.result.error="Error while creating folder"}):(GAPIServices.rename($scope.data.folderID,$scope.data.name,function(resp){}),$scope.result=response):$scope.result=response}))})},$scope.edit=function(id){$scope.result={},DataServices.Edit("Folders",id,function(response){$scope.data=response,$scope.selectedFolder=$filter("filter")($scope.folders,{id:$scope.data.parentID},!0)[0],$scope.parentFolderID=$scope.selectedFolder.folderID,$scope.fieldListJson=[],$scope.selectedFolder.fieldList&&angular.forEach(response.fieldList.split(";"),function(value,key){$scope.fieldListJson.push({fieldName:$scope.selectedFolder.fieldList.split("#")[key],fieldValue:value})})})},$scope.reset=function(){$scope.data={ID:0,name:"",desc:"",parentID:"",folderID:"",fieldList:""},$scope.selectedFolder=$scope.folders[0]}}]).controller("TagsCtrl",["DataServices","$rootScope","$scope",function(DataServices,$rootScope,$scope){$scope.data={ID:0,name:"",desc:""},$scope.submit=function(){$scope.data={ID:$scope.data.ID,name:$scope.data.name,desc:$scope.data.desc},DataServices.Submit("doTags",$scope.data,function(response){$scope.result=response})},$scope.edit=function(id){$scope.result={},DataServices.Edit("tags",id,function(response){$scope.data=response})},$scope.reset=function(){$scope.data={ID:0,name:"",desc:""}}}]).controller("UploadDocCtrl",["$q","GAPIServices","DataServices","$rootScope","$scope","$filter",function($q,GAPIServices,DataServices,$rootScope,$scope,$filter){function loadTags(){DataServices.SelectData("Tags","name",function(response){$scope.tags=response})}$scope.data={ID:0,folderID:0,docID:"OD"+randomString(8),name:"",desc:"",tags:"",fileID:randomString(8),isAuth:0},$scope.result={},$scope.tagsModel=[],DataServices.SelectData("SubFolders","name",function(response){$scope.subFolders=response,$scope.selectedSubFolder=function(selected){selected&&($scope.data.folderID=selected.originalObject.id,$scope.folderTitle=selected.originalObject.name,$scope.desc=selected.originalObject.desc)}}),loadTags(),$scope.browse=function(){document.getElementById("uploadFile").click()},$scope.getFile=function(){var file=document.getElementById("uploadFile").files[0],fileName=file.name;"pdf"==fileName.substr(fileName.length-3)?($scope.data.name=file.name,document.getElementById("Name").value=file.name):($scope.result.error="Please Select PDF only",document.getElementById("uploadFile").value="",$scope.data.name="No file selected")},$scope.loadTags=function($query){var deferred=$q.defer(),tags=$filter("filter")($scope.tags,{name:$query});return deferred.resolve(tags),deferred.promise},$scope.submit=function(){GAPIServices.login().then(function(){var file=document.getElementById("uploadFile").files[0];$scope.newtagsModel=$scope.tagsModel.map(function(tag){return tag.name}),0==$scope.data.ID?""!=document.getElementById("Name").value?0!=$scope.newtagsModel.length?($scope.data={action:"add",ID:$scope.data.ID,folderID:$scope.data.folderID,docID:$scope.data.docID,name:$scope.data.name,desc:$scope.data.desc,tags:$scope.newtagsModel,fileID:randomString(8),isAuth:$scope.data.isAuth},DataServices.Submit("doJDocs",$scope.data,function(response){$scope.result.notify="Saving Record...",void 0!=response.success?GAPIServices.upload(file,file.name,$scope.folderTitle).then(function(gapiResponse){$scope.result.notify="Uploading File...",void 0!=gapiResponse.id?($scope.data={action:"rename",ID:$scope.data.ID,folderID:$scope.data.subheadID,docID:response.data.newDocID,name:gapiResponse.title,desc:$scope.data.desc,tags:$scope.newtagsModel,fileID:gapiResponse.id,isAuth:$scope.data.isAuth},$scope.data.name=response.data.newDocID+" - "+$scope.data.name,DataServices.Submit("doJDocs",$scope.data,function(response){$scope.result=response}),GAPIServices.rename(gapiResponse.id,$scope.data.name,function(response){})):$scope.result.error="Error while uploading file in drive"}):$scope.result=response})):$scope.result={error:"Please Select tags"}:$scope.result={error:"Please Browse file"}:0!=$scope.newtagsModel.length?($scope.data={action:"update",ID:$scope.data.ID,folderID:$scope.data.folderID,docID:$scope.data.docID,name:$scope.data.name,desc:$scope.data.desc,tags:$scope.newtagsModel,fileID:$scope.data.fileID,isAuth:$scope.data.isAuth},DataServices.Submit("doJDocs",$scope.data,function(response){$scope.result=response})):$scope.result.error="Please Select tags"})},$scope.edit=function(id){$scope.result={},DataServices.Edit("jDocs",id,function(response){$scope.data=response,$scope.$broadcast("angucomplete-alt:changeInput","SubFolder",$filter("filter")($scope.subFolders,{id:$scope.data.folderID},!0)[0]);for(var tags=response.tags.split(";"),newTags=[],i=0;i<tags.length;i++)newTags.push({id:i,name:tags[i]});$scope.tagsModel=newTags})},$scope.reset=function(){$scope.data={ID:0,folderID:0,docID:"OD"+randomString(8),name:"",desc:"",tags:"",fileID:randomString(8),isAuth:0},$scope.tags={},$scope.tagsModel=[],$scope.$broadcast("angucomplete-alt:clearInput"),loadTags(),document.getElementById("uploadFile").value=""}}]).controller("AuthDocsCtrl",["GAPIServices","DataServices","$scope",function(GAPIServices,DataServices,$scope){function bindGrid(){var para={tblName:"AuthDocs",searchStr:""};DataServices.getData("getSearchData",para,function(response){$scope.docs=response})}DataServices.SelectData("SubFolders","name",function(response){$scope.subFolders=response,$scope.selectedSubFolder=$scope.subFolders[0],$scope.selectSubFolder=function(selected){selected&&($scope.subFolderID=selected.id,$scope.folderID=selected.folderID)}}),bindGrid(),$scope.checked=function(doc){var para={action:"authorize",ID:doc.ID,folderID:"",docID:"",name:"",desc:"",tags:"",fileID:"",isAuth:doc.isAuth};DataServices.Submit("doJDocs",para,function(response){})},$scope.move=function(doc){GAPIServices.login().then(function(){var para={action:"move",ID:doc.ID,folderID:$scope.subFolderID,docID:"",name:"",desc:"",tags:"",fileID:"",isAuth:0};DataServices.Submit("doJDocs",para,function(response){void 0!=response.success?GAPIServices.copy(doc.fileID,$scope.folderID,function(gapiResponse){if(void 0!=gapiResponse.id){var para={action:"rename",ID:0,folderID:"",docID:doc.docID,name:doc.name,desc:"",tags:"",fileID:gapiResponse.id,isAuth:0};DataServices.Submit("doJDocs",para,function(response){bindGrid()})}else console.error("Error while moving file to drive")}):console.error("Error while saving record")})})},$scope.delete=function(doc){confirm("Do you want to delete this file?")&&GAPIServices.login().then(function(){var para={action:"delete",ID:doc.ID,folderID:"",docID:"",name:"",desc:"",tags:"",fileID:"",isAuth:0};DataServices.Submit("doJDocs",para,function(response){void 0!=response.success?(GAPIServices.deleteFile(doc.fileID),bindGrid()):console.error("Error while deleting record")})})}}]).controller("downloadDocsCtrl",["DataServices","$scope","$sce",function(DataServices,$scope,$sce){function downloadAll(urls){var link=document.createElement("a");link.setAttribute("download",null),link.style.display="none",document.body.appendChild(link);for(var i in urls)link.setAttribute("href",urls[i]),link.click();document.body.removeChild(link)}$scope.data={},$scope.btnName="View",$scope.view=function(){if("Reset"==$scope.btnName)$scope.data={},$scope.btnName="View",$scope.$broadcast("angucomplete-alt:clearInput"),$scope.files=[];else{var para={tblName:"jDocs",searchStr:""};DataServices.getData("getSearchData",para,function(response){$scope.files=response,$scope.btnName="Reset"})}},$scope.download=function(){$scope.allWebContentLink=[];for(var i in $scope.files)1==$scope.files[i].checked&&($scope.webContentLink="https://drive.google.com/uc?id="+$scope.files[i].fileID+"&export=download",$scope.allWebContentLink.push($scope.webContentLink));downloadAll($scope.allWebContentLink)},$scope.highlight=function(text,search){return search?$sce.trustAsHtml(text.replace(new RegExp(search,"gi"),'<span style="background-color:#ff9;">$&</span>')):$sce.trustAsHtml(text)}}]).controller("ViewDocsCtrl",["$q","GAPIServices","DataServices","$sce","$rootScope","$scope","$filter","$window",function($q,GAPIServices,DataServices,$sce,$rootScope,$scope,$filter,$window){function downloadAll(urls){var link=document.createElement("a");link.setAttribute("download",null),link.style.display="none",document.body.appendChild(link);for(var i in urls)link.setAttribute("href",urls[i]),link.click();document.body.removeChild(link)}function ViewSubFolder(folderid){$scope.data=[];var Header=[],tableJson=[],folderFieldList=$filter("filter")($scope.folders,{ID:folderid})[0].fieldList;if($scope.subFolderJson=$filter("filter")($scope.subFolders,{parentID:folderid},!0),$scope.noFiles=!1,folderFieldList){folderFieldList=folderFieldList.split("#");for(i=0;i<folderFieldList.length;i++)Header.push({name:folderFieldList[i]});$scope.fieldListHeader=Header}else $scope.fieldListHeader=[];if($scope.subFolderJson.length){for(var i=0;i<$scope.subFolderJson.length;i++)if($scope.subFolderJson[i].fieldList){fieldListValue=[];if((value=$scope.subFolderJson[i].fieldList.split(";")).length==folderFieldList.length){for(j=0;j<value.length;j++)fieldListValue.push(value[j]);tableJson.push({ID:$scope.subFolderJson[i].ID,name:$scope.subFolderJson[i].name,desc:$scope.subFolderJson[i].desc,fieldList:fieldListValue})}else value[1]="<i>No of column doesnt maches, Please check the data</i>",fieldListValue.push(value[1]),tableJson.push({ID:$scope.subFolderJson[i].ID,name:$scope.subFolderJson[i].name,desc:$scope.subFolderJson[i].desc,fieldList:fieldListValue})}else if($scope.fieldListHeader){for(var value=[],fieldListValue=[],j=0;j<$scope.fieldListHeader.length;j++)value[j]=" ",fieldListValue.push(value[j]);tableJson.push({ID:$scope.subFolderJson[i].ID,name:$scope.subFolderJson[i].name,desc:$scope.subFolderJson[i].desc,fieldList:fieldListValue})}else tableJson.push({ID:$scope.subFolderJson[i].ID,name:$scope.subFolderJson[i].name,desc:$scope.subFolderJson[i].desc});$scope.subFolderData=tableJson}else $scope.noFiles=!0}$scope.reportTitle="",$scope.reportDate=getCurrentDate(),$scope.deleteFolderName="",$scope.fieldList=[],setTimeout(function(){$(window).width();var vph=$(window).height();document.getElementById("subFolders-container").style.height=vph-250+"px",document.getElementById("doc-container").style.height=vph-100+"px",window.onresize=function(){$(window).width();var vph=$(window).height();document.getElementById("subFolders-container").style.height=vph-250+"px",document.getElementById("doc-container").style.height=vph-100+"px"}},1),function(){var para={tblName:"Folders",coloumnName:""};DataServices.getData("getSearchData",para,function(response){$scope.folders=response})}(),function(){var para={tblName:"Sub-Folders",coloumnName:""};DataServices.getData("getSearchData",para,function(response){$scope.subFolders=response})}(),$scope.viewSubFoldersList=function(folderid){$scope.searchStr="",$scope.subFolderData=[],$scope.reportTitle=$filter("filter")($scope.folders,{ID:folderid},!0)[0].name,$scope.subFoldersList=$filter("filter")($scope.subFolders,{parentID:folderid}),ViewSubFolder(folderid)},$scope.checkAll=function(){for(var i in $scope.data)1==$scope.selectAll?$scope.data[i].checked=!0:$scope.data[i].checked=!1},$scope.view=function(subFolder){$scope.searchStr="",$scope.bindDeletedSubFolders=subFolder;var para={subheadID:subFolder.ID};DataServices.getData("viewDocs",para,function(response){response.length?($scope.data=response,$scope.noFiles=!1):$scope.noFiles=!0})},$scope.highlight=function(text,search){return search?$sce.trustAsHtml(text.replace(new RegExp(search,"gi"),'<span style="background-color:#FF9;">$&</span>')):$sce.trustAsHtml(text)},$scope.print=function(){window.print()},$scope.download=function(){$scope.allWebContentLink=[];for(var i in $scope.data)1==$scope.data[i].checked&&($scope.webContentLink="https://drive.google.com/uc?id="+$scope.data[i].fileID+"&export=download",$scope.allWebContentLink.push($scope.webContentLink));downloadAll($scope.allWebContentLink)},$scope.trash=function(){GAPIServices.login().then(function(){for(var i in $scope.data)1==$scope.data[i].checked&&1==confirm("Are you sure you want to move "+$scope.data[i].name+"to Trash.")&&GAPIServices.trashFile($scope.data[i].fileID).then(function(gapiResponse){gapiResponse.id?($scope.trashdata={ID:$scope.data[i].ID,userId:$rootScope.globals.currentUser.ID},DataServices.Submit("doJDocsTrash",$scope.trashdata,function(response){$scope.view($scope.bindDeletedSubFolders)})):console.log(gapiResponse)})})}}]).controller("SearchDocsCtrl",["DataServices","$sce","$scope",function(DataServices,$sce,$scope){function downloadAll(urls){var link=document.createElement("a");link.setAttribute("download",null),link.style.display="none",document.body.appendChild(link);for(var i in urls)link.setAttribute("href",urls[i]),link.click();document.body.removeChild(link)}$scope.data={},setTimeout(function(){$(window).width();var vph=$(window).height();document.getElementById("doc-container").style.height=vph-100+"px",window.onresize=function(){$(window).width();var vph=$(window).height();document.getElementById("doc-container").style.height=vph-100+"px"}},1),$scope.view=function(searchStr){var para={searchStr:searchStr};DataServices.getData("searchDocs",para,function(response){$scope.data=response,$scope.showNoFiles=!0})},$scope.viewOnEnter=function(keyEvent){13===keyEvent.which&&$scope.view()},$scope.download=function(){$scope.allWebContentLink=[];for(var i in $scope.data)1==$scope.data[i].checked&&($scope.webContentLink="https://drive.google.com/uc?id="+$scope.data[i].fileID+"&export=download",$scope.allWebContentLink.push($scope.webContentLink));downloadAll($scope.allWebContentLink)},$scope.checkAll=function(){for(var i in $scope.data)1==$scope.selectAll?$scope.data[i].checked=!0:$scope.data[i].checked=!1},$scope.highlight=function(text,search){return search?$sce.trustAsHtml(text.replace(new RegExp(search,"gi"),'<span style="background-color:#FF9;">$&</span>')):$sce.trustAsHtml(text)}}])}(),function(){"use strict";angular.module("Payroll").controller("CompanyCtrl",["DataServices","$scope","$filter",function(DataServices,$scope,$filter){$scope.data={ID:0,name:"",address:"",cityID:0,stateID:0,pinCode:"",panNo:"",tanNo:"",directorName:"",directorFName:"",directorDsgn:""},DataServices.SelectData("Cities","name",function(response){$scope.cities=response,$scope.selectedCity=function(selected){selected&&($scope.data.cityID=selected.originalObject.id)}}),DataServices.SelectData("States","name",function(response){$scope.states=response,$scope.selectedState=function(selected){selected&&($scope.data.stateID=selected.originalObject.id)}}),$scope.submit=function(){DataServices.Submit("doCompanies",$scope.data,function(response){$scope.result=response})},$scope.edit=function(id){$scope.result={},DataServices.Edit("Companies",id,function(response){$scope.data=response,$scope.$broadcast("angucomplete-alt:changeInput","Cities",$filter("filter")($scope.cities,{id:$scope.data.cityID},!0)[0]),$scope.$broadcast("angucomplete-alt:changeInput","States",$filter("filter")($scope.states,{id:$scope.data.stateID},!0)[0])})},$scope.reset=function(){$scope.data={ID:0,name:"",address:"",cityID:0,stateID:0,pinCode:"",panNo:"",tanNo:"",directorName:"",directorFName:"",directorDsgn:""},$scope.$broadcast("angucomplete-alt:clearInput")}}]).controller("DivisionCtrl",["DataServices","$rootScope","$scope","$filter",function(DataServices,$rootScope,$scope,$filter){$scope.data={ID:0,coID:0,name:"",prefixCode:"",address:"",cityID:0,stateID:0,pinCode:"",pfNo:"",esicNo:"",ptaxNo:"",licNo:"",licFreq:"",licCategory:""},DataServices.SelectData("Companies","name",function(response){$scope.companies=response,$scope.selectedCompany=$scope.companies[0],$scope.selectCompany=function(selected){$scope.data.coID=selected.id}}),DataServices.SelectData("Cities","name",function(response){$scope.cities=response,$scope.selectedCity=function(selected){selected&&($scope.data.cityID=selected.originalObject.id)}}),DataServices.SelectData("States","name",function(response){$scope.states=response,$scope.selectedState=function(selected){selected&&($scope.data.stateID=selected.originalObject.id)}}),$scope.submit=function(){DataServices.Submit("doDivisions",$scope.data,function(response){$scope.result=response})},$scope.edit=function(id){$scope.result={},DataServices.Edit("Divisions",id,function(response){$scope.data=response,$scope.selectedCompany=$filter("filter")($scope.companies,{id:$scope.data.coID})[0],$scope.$broadcast("angucomplete-alt:changeInput","Cities",$filter("filter")($scope.cities,{id:$scope.data.cityID},!0)[0]),$scope.$broadcast("angucomplete-alt:changeInput","States",$filter("filter")($scope.states,{id:$scope.data.stateID},!0)[0])})},$scope.reset=function(){$scope.data={ID:0,coID:0,name:"",prefixCode:"",address:"",cityID:0,stateID:0,pinCode:"",pfNo:"",esicNo:"",ptaxNo:"",licNo:"",licFreq:"",licCategory:""},$scope.$broadcast("angucomplete-alt:clearInput"),$scope.selectedCompany=$scope.companies[0]}}]).controller("HolidaysCtrl",["DataServices","$scope","$filter",function(DataServices,$scope,$filter){function bindGrid(){var para={tblName:"Holidays",searchStr:""};DataServices.getData("getSearchData",para,function(response){$scope.holidays=response;for(var i=0;i<$scope.holidays.length;i++)$scope.holidays[i].date=$filter("date")(parseInt($scope.holidays[i].date.substr(6,13)),"dd/MM/yyyy")})}$scope.data={ID:0},bindGrid(),$scope.save=function(para){DataServices.Submit("doHolidays",para,function(response){$scope.result=response,bindGrid(),$scope.data={ID:0}})},$scope.setEditMode=function(value){$scope.editMode=value}}]).controller("MasterCtrl",["DataServices","$rootScope","$scope",function(DataServices,$rootScope,$scope){$scope.data={ID:0},$scope.submit=function(){$scope.data={tblName:$scope.contents[$rootScope.currentModuleId].tblName,ID:$scope.data.ID,name:$scope.data.name,desc:$scope.data.desc},DataServices.Submit("doMaster",$scope.data,function(response){$scope.result=response})},$scope.edit=function(id){$scope.result={},DataServices.Edit($scope.contents[$rootScope.currentModuleId].tblName,id,function(response){$scope.data=response})},$scope.reset=function(){$scope.data={ID:0}}}]).controller("ShiftsCtrl",["DataServices","$scope",function(DataServices,$scope){function bindGrid(){var para={tblName:"Shifts",searchStr:""};DataServices.getData("getSearchData",para,function(response){$scope.shifts=response})}$scope.data={ID:0,name:"",code:"",inTime:"",outTime:"",nextDayOut:0},bindGrid(),$scope.save=function(para){DataServices.Submit("doShifts",para,function(response){$scope.result=response,bindGrid(),$scope.data={ID:0,name:"",code:"",inTime:"",outTime:"",nextDayOut:0}})},$scope.setEditMode=function(value){$scope.editMode=value}}]).controller("SlabCtrl",["DataServices","$rootScope","$scope",function(DataServices,$rootScope,$scope){function bindGrid(){var para={tblName:$scope.contents[$rootScope.currentModuleId].tblName,searchStr:""};DataServices.getData("getSearchData",para,function(response){$scope.slabs=response})}$scope.data={ID:0},$scope.slabs=[],DataServices.SelectData("States","Name",function(response){$scope.states=response,$scope.selectedState=function(selected){selected&&($scope.stateID=selected.originalObject.id,bindGrid())}}),$scope.save=function(para){para={tblName:$scope.contents[$rootScope.currentModuleId].tblName,ID:para.ID,stateID:$scope.data.stateID,fromAmt:para.fromAmt,toAmt:para.toAmt,deduction:para.deduction},DataServices.Submit("doSlab",para,function(response){$scope.result=response,bindGrid(),$scope.data={ID:0}})},$scope.reset=function(){$scope.data={ID:0},$scope.$broadcast("angucomplete-alt:clearInput"),$scope.slabs=[]},$scope.setEditMode=function(value){$scope.editMode=value}}]).controller("EmployeesCtrl",["DataServices","$scope","$filter",function(DataServices,$scope,$filter){$scope.data={ID:0,empID:"",cardID:"",status:"W",firstName:"",middleName:"",lastName:"",dob:"",gender:"",maritalStatus:"",roomNo:"",location:"",street:"",area:"",cityID:0,stateID:0,pinCode:"",nRoomNo:"",nLocation:"",nStreet:"",nArea:"",nCityID:0,nStateID:0,nPinCode:"",resTel:"",mobile:"",emgTel:"",email:"",bloodGroup:"",doj:"",coID:1,divID:1,deptID:0,dsgnID:0,gradeID:0,pan:"",isHandicapped:0,isPT:0,isPF:0,pfNo:"",isESIC:0,esicNo:"",isLWF:0,lwfNo:"",licNo:"",dol:"",bank:"",branch:"",bCityID:0,bStateID:0,bAcNo:"",ifsc:"",photo:"",aadharNo:"",uanAno:""},$scope.nominees=[],$scope.BGs=[{id:"0",name:"-"},{id:"1",name:"A+"},{id:"2",name:"B+"},{id:"3",name:"AB+"},{id:"4",name:"O+"},{id:"5",name:"A-"},{id:"6",name:"B-"},{id:"7",name:"AB-"},{id:"8",name:"O-"}],$scope.selectedBG=$scope.BGs[0],$scope.selectBG=function(selectedBG){$scope.data.bloodGroup=selectedBG.name},$scope.MSs=[{id:"1",name:"Married"},{id:"2",name:"Unmarried"}],$scope.selectedMS=$scope.MSs[0],$scope.selectMS=function(selectedMS){$scope.data.maritalStatus=selectedMS.name},DataServices.SelectData("Grade","Name",function(response){$scope.grades=response,$scope.selectedGrade=$scope.grades[0],$scope.selectGrade=function(selectedGrade){$scope.data.gradeID=selectedGrade.id}}),DataServices.SelectData("Cities","Name",function(response){$scope.cities=response,$scope.ncities=response,$scope.bcities=response,$scope.nselectedCity=function(selected){selected&&($scope.data.nCityID=selected.originalObject.id)},$scope.bselectedCity=function(selected){selected&&($scope.data.bCityID=selected.originalObject.id)},$scope.selectedCity=function(selected){selected&&($scope.data.cityID=selected.originalObject.id)}}),DataServices.SelectData("States","name",function(response){$scope.states=response,$scope.selectedState=function(selected){selected&&($scope.stateID=selected.originalObject.id,bindGrid())}})}]).controller("EmpQECtrl",["DataServices","$rootScope","$scope",function(DataServices,$rootScope,$scope){function bindGrid(){var para={divID:$rootScope.globals.currentDivision.ID,field:$scope.data.fieldName};DataServices.getData("getEmployeesQE",para,function(response){$scope.employees=response})}$scope.data=[],DataServices.SelectData("EmployeesQE","name",function(response){$scope.fields=response,$scope.selectedField=$scope.fields[0],$scope.selectField=function(selectedField){$scope.data.fieldName=selectedField.name,bindGrid()}}),$scope.save=function(emp){var para={ID:emp.ID,field:$scope.data.fieldName,value:emp.value};DataServices.Submit("doEmployeesQE",para,function(response){$scope.result=response,bindGrid()})},$scope.setEditMode=function(mode){$scope.editMode=mode}}])}(),function(){"use strict";angular.module("Payroll").controller("PMPYCtrl",["DataServices","$rootScope","$scope","$filter",function(DataServices,$rootScope,$scope,$filter){function bindGrid(){DataServices.getData("getPMPYEmployees",{command:$scope.selectedOption.id,divID:$rootScope.globals.currentDivision.ID},function(response){$scope.employees=response})}$scope.pmpyEmpSummary={},$scope.employees={},$scope.selectedOption=[],$scope.options=[{id:"0",name:"(Select)"},{id:"1",name:"KYC Pending"},{id:"2",name:"PMPY Pending"},{id:"3",name:"PMPY Enrolled"},{id:"4",name:"Eligible"},{id:"5",name:"Not Eligible"},{id:"6",name:"Total Employees"}],$scope.selectedOption=$scope.options[0],$scope.selectOption=function(selectedOption){0!=selectedOption.id&&bindGrid()},DataServices.getData("getPMPYEmployeesSummary",{divID:$rootScope.globals.currentDivision.ID},function(response){$scope.pmpyEmpSummary=response[0]}),$scope.setEditMode=function(mode){$scope.editMode=mode},$scope.updatePMPYStatus=function(empID){confirm("Do you want to Update the Status?")?DataServices.Submit("updateEmpPMPYStatus",{empID:empID,pmpyStatus:$scope.selectedOption.id},function(response){bindGrid()}):$filter("filter")($scope.employees,{empID:empID},!0)[0].pmpyStatus=0}}]).controller("EmpInfoCtrl",["DataServices","$scope",function(DataServices,$scope){function initialise(){$scope.data={},$scope.data.divID=1,$scope.btnName="View",$scope.disableEmp=!1,$scope.$broadcast("angucomplete-alt:clearInput")}initialise(),DataServices.SelectData("Employees","firstName",function(response){$scope.employees=response}),$scope.selectedEmp=function(selected){selected&&($scope.data.EmpID=selected.originalObject.id)},$scope.view=function(){if("Reset"==$scope.btnName)initialise();else{var para={divID:$scope.data.divID,EmpID:$scope.data.EmpID};DataServices.getData("GetEmpInfo",para,function(response){$scope.data=response[0],$scope.reportData=[],$scope.reportData.date=getCurrentDate(),$scope.disableEmp=!0,$scope.btnName="Reset"})}}}]).controller("DailyAttnCtrl",["DataServices","$scope",function(DataServices,$scope){function initialise(){$scope.data={},$scope.data.DivId=1,$scope.data.SDate="2014-02-01",$scope.data.EDate="2014-02-28",$scope.btnName="View",$scope.gridData=[],$scope.collection={},$scope.$broadcast("angucomplete-alt:clearInput"),$scope.disableDept=!1}initialise(),DataServices.SelectData("Dept","name",function(response){$scope.deptName=response}),$scope.selectedDept=function(selected){selected&&($scope.data.DeptId=selected.originalObject.id)},$scope.view=function(){if("Reset"==$scope.btnName)initialise();else{var para={DivId:$scope.data.DivId,DeptId:$scope.data.DeptId,SDate:$scope.data.SDate,EDate:$scope.data.EDate};DataServices.getData("AttnInfo",para,function(response){response.length>0?($scope.gridData=response[0],$scope.collection=response,$scope.reportData=[],$scope.reportData.date=getCurrentDate(),$scope.btnName="Reset",$scope.disableDept=!0):(alert("Data not found"),initialise())})}}}]).controller("LateEarlyInfoCtrl",["DataServices","$scope","$filter",function(DataServices,$scope,$filter){function initialise(){$scope.data={},$scope.data.DivId=14,$scope.data.SDate="2011-08-02",$scope.data.EDate="2011-08-31",$scope.btnName="View",$scope.collection=[],$scope.reportData=[],$scope.reportData.date=getCurrentDate()}initialise(),$scope.view=function(){if("Reset"==$scope.btnName)initialise();else{var para={DivId:$scope.data.DivId,SDate:$scope.data.SDate,EDate:$scope.data.EDate,LateMinutes:$scope.data.LateMinutes};DataServices.getData("getLateEarlyInfo",para,function(response){response.length>0?($scope.gridData=response[0],$scope.collection=response,$scope.reportData=[],$scope.reportData.date=getCurrentDate(),$scope.btnName="Reset"):(alert("Data not found"),initialise())})}}}]).controller("DutyHoursCtrl",["DataServices","$scope","$filter",function(DataServices,$scope,$filter){function initialise(){$scope.data={},$scope.gridData=[],$scope.collection=[],$scope.data.DivId=1,$scope.data.SDate="2014-02-01",$scope.data.EDate="2014-03-30",$scope.$broadcast("angucomplete-alt:clearInput"),$scope.btnName="View",$scope.disableDept=!1}initialise(),DataServices.SelectData("Dept","name",function(response){$scope.deptName=response}),$scope.selectedDept=function(selected){selected&&($scope.data.DeptId=selected.originalObject.id)},$scope.view=function(){if("Reset"==$scope.btnName)initialise();else{var para={DivId:$scope.data.DivId,DeptId:$scope.data.DeptId,SDate:$scope.data.SDate,EDate:$scope.data.EDate};DataServices.getData("getDutyHrsInfo",para,function(response){response.length>0?($scope.gridData=response[0],$scope.collection=response,$scope.reportData=[],$scope.reportData.date=getCurrentDate(),$scope.disableDept=!0,$scope.btnName="Reset"):(alert("Data not found"),initialise())})}}}]).controller("SalRegisterCtrl",["DataServices","$scope",function(DataServices,$scope){function initialise(){$scope.data={},$scope.data.DivId=1,$scope.gridData=[],$scope.collection=[],$scope.content.viewMode=!1,$scope.btnName="View"}initialise(),$scope.months=[{id:"0",name:"(Select)"},{id:"1",name:"January"},{id:"2",name:"February"},{id:"3",name:"March"},{id:"4",name:"April"},{id:"5",name:"May"},{id:"6",name:"June"},{id:"7",name:"July"},{id:"8",name:"August"},{id:"9",name:"September"},{id:"10",name:"October"},{id:"11",name:"November"},{id:"12",name:"December"}],$scope.selectedMonth=$scope.months[0],$scope.selectMonth=function(selectedMonth){$scope.month=selectedMonth.id};var yr=(new Date).getFullYear();$scope.years=[{id:"0",name:"(Select)"},{id:"1",name:yr-3},{id:"2",name:yr-2},{id:"3",name:yr-1},{id:"4",name:yr},{id:"5",name:yr+1},{id:"6",name:yr+2}],$scope.selectedYear=$scope.years[0],$scope.selectYear=function(selectedYear){$scope.year=selectedYear.name},$scope.view=function(){if("Reset"==$scope.btnName)initialise();else{var para={};para.DivId=$scope.data.DivId,para.month=$scope.month,para.year=$scope.year,DataServices.getData("GetSalaryRegister",para,function(response){$scope.selectedMonth!=$scope.months[0]&&$scope.selectedYear!=$scope.years[0]&&response.length>0?($scope.gridData=response[0],$scope.collection=response,$scope.reportData=[],$scope.reportData.date=getCurrentDate(),$scope.content.viewMode=!0,$scope.btnName="Reset"):(alert("Data not found"),initialise())})}}}]).controller("SalSummaryCtrl",["DataServices","$rootScope","$scope","$filter",function(DataServices,$rootScope,$scope,$filter){function loadMonths(){$scope.months=[{id:"0",name:"(Select)"},{id:"1",name:"January"},{id:"2",name:"February"},{id:"3",name:"March"},{id:"4",name:"April"},{id:"5",name:"May"},{id:"6",name:"June"},{id:"7",name:"July"},{id:"8",name:"August"},{id:"9",name:"September"},{id:"10",name:"October"},{id:"11",name:"November"},{id:"12",name:"December"}],$scope.selectedMonth=$scope.months[0],$scope.selectMonth=function(selectedMonth){$scope.month=selectedMonth.id}}function loadYears(){var yr=(new Date).getFullYear();$scope.years=[{id:"0",name:"(Select)"},{id:"1",name:yr-3},{id:"2",name:yr-2},{id:"3",name:yr-1},{id:"4",name:yr},{id:"5",name:yr+1},{id:"6",name:yr+2}],$scope.selectedYear=$scope.years[0],$scope.selectYear=function(selectedYear){$scope.year=selectedYear.name}}function loadTypes(){$scope.types=[{id:"0",name:"(Select)"},{id:"1",name:"Salary Summary"},{id:"2",name:"PT Summary"},{id:"3",name:"PF Challan"},{id:"4",name:"Pay Type Summary"}],$scope.selectedType=$scope.types[0],$scope.selectType=function(selectedType){$scope.type=selectedType.name}}function getSalarySummary(){$scope.result={};var para={};para.DivId=$scope.data.DivId,para.month=$scope.month,para.year=$scope.year,DataServices.getData("getSalarySummary",para,function(response){$scope.collection=response,$scope.content.viewMode=!0,$scope.viewSalary=!0,$scope.viewSalaryContent=!1})}function getSalaryContentSummary(spName){$scope.result={};var para={};para.DivId=$scope.data.DivId,para.month=$scope.month,para.year=$scope.year,DataServices.getData($rootScope.globals.currentDB.dbName+spName,para,function(response){$scope.contents[$rootScope.currentModuleId].viewData=response,$scope.colHeaders=Object.keys($scope.contents[$rootScope.currentModuleId].viewData[0]),$scope.content.viewMode=!0,$scope.viewSalaryContent=!0,$scope.viewSalary=!1})}$scope.reportData={},$scope.data={},$scope.data.DivId=1,$scope.collection=[],$scope.reportData.date=getCurrentDate(),loadMonths(),loadYears(),loadTypes(),$scope.view=function(){"(Select)"==$scope.type&&($scope.viewSalary=!1,$scope.viewSalaryContent=!1),"Salary Summary"==$scope.type&&getSalarySummary(),"PT Summary"==$scope.type&&getSalaryContentSummary(".dbo.getPTSummary"),"PF Challan"==$scope.type&&getSalaryContentSummary(".dbo.getPFChallan"),"Pay Type Summary"==$scope.type&&getSalaryContentSummary(".dbo.getPayTypeSummary")},$scope.reset=function(){$scope.data={},$scope.data.DivId=1,$scope.collection=[],$scope.getCurrentDate=$filter("date")(new Date,"dd/MM/yyyy"),$scope.getCurrentTime=$filter("date")(new Date,"HH:mm:ss"),loadMonths(),loadYears(),loadTypes()}}]).controller("EmpLoanInfoCtrl",["DataServices","$rootScope","$scope","$filter",function(DataServices,$rootScope,$scope,$filter){function initialise(){$scope.reportData={},$scope.data={},$scope.total={},$scope.collection=[],$scope.reportData.date=getCurrentDate(),$scope.total.AddAmt=0,$scope.total.LessAmt=0,$scope.total.OutSidePaid=0,$scope.Balance=0,$scope.btnName="View",$scope.content.viewMode=!1,$scope.disableEmp=!1,$scope.$broadcast("angucomplete-alt:clearInput")}initialise(),$scope.report=[{companyName:"Juliet Apparels ltd.",companyAddress:"313, Shah & Nahar ind. Estate, S.J. Marg, Lower Parel,, Mumbai - 400013, Maharashtra"}];var rpt=[];rpt=angular.fromJson($scope.report),$scope.report.companyName=rpt[0].companyName,$scope.report.companyAddress=rpt[0].companyAddress,DataServices.SelectData("Employees","firstName",function(response){$scope.empName=response}),$scope.selectedEmp=function(selected){selected&&($scope.data.EmpID=selected.originalObject.id)},$scope.view=function(){if("Reset"==$scope.btnName)initialise();else{var para={divID:1,EmpID:$scope.data.EmpID};DataServices.getData("getEmpLoanInfo",para,function(response){if(response.length<=0)alert("No record found!!!"),initialise();else{$scope.data=response[0],$scope.collection=response;for(var i=0;i<$scope.collection.length;i++)$scope.total.AddAmt=$scope.total.AddAmt+$scope.collection[i].AddAmt,$scope.total.LessAmt=$scope.total.LessAmt+$scope.collection[i].LessAmt,$scope.total.OutSidePaid=$scope.total.OutSidePaid+$scope.collection[i].OutSidePaid;$scope.Balance=$scope.total.AddAmt-($scope.total.LessAmt+$scope.total.OutSidePaid),$scope.content.viewMode=!0,$scope.disableEmp=!0,$scope.btnName="Reset"}})}}}]).controller("DutyHoursSummaryCtrl",["DataServices","$rootScope","$scope","$filter",function(DataServices,$rootScope,$scope,$filter){function initialise(){$scope.data={},$scope.data.DivId=1,$scope.data.SDate="2014-02-01",$scope.data.EDate="2014-02-28",$scope.btnName="View",$scope.content.viewMode=!1,$scope.reportData=[]}initialise(),$scope.view=function(){if("Reset"==$scope.btnName)initialise();else{var para={DivId:$scope.data.DivId,SDate:$scope.data.SDate,EDate:$scope.data.EDate};DataServices.getData("getDeptDutyHrs",para,function(response){response.length<=0?(alert("Data not found"),initialise()):($scope.reportData=[],$scope.content.viewMode=!0,$scope.btnName="Reset",$scope.reportData=response,$scope.reportData.date=getCurrentDate(),$scope.reportData.rpt_colHeaders=Object.keys($scope.reportData[0]))})}}}]).controller("IrregularInfoCtrl",["DataServices","$rootScope","$scope","$filter",function(DataServices,$rootScope,$scope,$filter){function initialise(){$scope.data={},$scope.gridData={},$scope.data.DivId=1,$scope.data.SDate="2014-04-01",$scope.data.EDate="2014-04-30",$scope.$broadcast("angucomplete-alt:clearInput"),$scope.btnName="View",$scope.disableDept=!1,$scope.content.viewMode=!1,loadDepartments()}function loadDepartments(){$scope.requireDept=!0,$scope.deptName={},DataServices.SelectData("Dept","name",function(response){$scope.deptName=response}),$scope.selectedDept=function(selected){selected&&($scope.data.DeptId=selected.originalObject.id)}}initialise(),$scope.view=function(){if("Reset"==$scope.btnName)initialise();else{var para={DivId:$scope.data.DivId,DeptId:$scope.data.DeptId,IrregularDays:$scope.data.IrregularDays,SDate:$scope.data.SDate,EDate:$scope.data.EDate};DataServices.getData("getIrregularInfo",para,function(response){if(response.length>0){$scope.gridData=response[0],$scope.collection=response,$scope.reportData=[],$scope.reportData.date=getCurrentDate(),$scope.content.viewMode=!0,$scope.disableDept=!0,$scope.btnName="Reset",$scope.totalStatus=0;for(var i=0;i<$scope.collection.length;i++)"A"==$scope.collection[i].Status&&($scope.totalStatus=$scope.totalStatus+1)}else alert("Data not found"),initialise()})}}}]).controller("AttendanceCtrl",["DataServices","$rootScope","$scope","$filter",function(DataServices,$rootScope,$scope,$filter){function initialise(){$scope.data={},$scope.gridData={},$scope.data.SDate="2014-02-01",$scope.data.EDate="2014-02-28",$scope.$broadcast("angucomplete-alt:clearInput"),$scope.btnName="View",$scope.content.viewMode=!1,$scope.disableDept=!1,loadDepartments()}function loadDepartments(){$scope.requireDept=!0,$scope.deptName={},DataServices.SelectData("Dept","name",function(response){$scope.deptName=response}),$scope.selectedDept=function(selected){selected&&($scope.data.DeptID=selected.originalObject.id,$scope.gridData.Dept=selected.originalObject.name)}}initialise(),$scope.view=function(){if("Reset"==$scope.btnName)initialise();else{$scope.result={};var para={};para.DivID=1,para.DeptID=$scope.data.DeptID,para.SDate=$scope.data.SDate,para.EDate=$scope.data.EDate,DataServices.getData("GetAttendance",para,function(response){response.length>0?($scope.collection=response,$scope.gridData=response[0],$scope.reportData=[],$scope.reportData.date=getCurrentDate(),$scope.content.viewMode=!0,$scope.disableDept=!0,$scope.btnName="Reset"):(alert("Data not found"),initialise())})}}}]).controller("AttnDetailsCtrl",["DataServices","$rootScope","$scope","$filter",function(DataServices,$rootScope,$scope,$filter){function initialise(){$scope.data={},$scope.gridData={},$scope.data.SDate="2014-02-01",$scope.data.EDate="2014-02-28",$scope.collectionM=[],$scope.btnName="View",$scope.disableDept=!1,$scope.content.viewMode=!1,$scope.$broadcast("angucomplete-alt:clearInput"),loadDepartments()}function loadDepartments(){$scope.requireDept=!0,$scope.deptName={},DataServices.SelectData("Dept","name",function(response){$scope.deptName=response}),$scope.selectedDept=function(selected){selected&&($scope.data.DeptID=selected.originalObject.id,$scope.gridData.Dept=selected.originalObject.name)}}initialise(),$scope.view=function(){if("Reset"==$scope.btnName)initialise();else{$scope.result={};var para={};para.DivID=1,para.DeptID=$scope.data.DeptID,para.SDate=$scope.data.SDate,para.EDate=$scope.data.EDate,DataServices.getData("GetAttendance",para,function(response){if(response.length>0){$scope.content.viewMode=!0,$scope.disableDept=!0,$scope.btnName="Reset",$scope.gridData=response[0],$scope.collection=response,$scope.reportData=[],$scope.reportData.date=getCurrentDate(),$scope.collectionM=[{id:"1",M_value:""},{id:"2",M_value:""},{id:"3",M_value:""},{id:"4",M_value:""},{id:"5",M_value:""},{id:"6",M_value:""},{id:"7",M_value:""},{id:"8",M_value:""},{id:"9",M_value:""},{id:"10",M_value:""},{id:"11",M_value:""},{id:"12",M_value:""},{id:"13",M_value:""},{id:"14",M_value:""},{id:"15",M_value:""},{id:"16",M_value:""},{id:"17",M_value:""},{id:"18",M_value:""},{id:"19",M_value:""},{id:"20",M_value:""},{id:"21",M_value:""},{id:"22",M_value:""},{id:"23",M_value:""},{id:"24",M_value:""},{id:"25",M_value:""},{id:"26",M_value:""},{id:"27",M_value:""},{id:"28",M_value:""},{id:"29",M_value:""},{id:"30",M_value:""}];for(var i=0;i<$scope.collection.length;i++)"P"!=$scope.collection[i].Status&&($scope.collectionM[i].M_value="M")}else alert("Data not found"),initialise()})}},$scope.reset=function(){initialise()}}]).controller("AttnInfoShiftWiseCtrl",["DataServices","$rootScope","$scope","$filter",function(DataServices,$rootScope,$scope,$filter){function initialise(){$scope.data={},$scope.gridData={},$scope.data.SDate="2014-02-01",$scope.data.EDate="2014-02-28",$scope.$broadcast("angucomplete-alt:clearInput"),$scope.btnName="View",$scope.disableDept=!1,$scope.content.viewMode=!1,loadDepartments()}function loadDepartments(){$scope.requireDept=!0,$scope.deptName={},DataServices.SelectData("Dept","name",function(response){$scope.deptName=response}),$scope.selectedDept=function(selected){selected&&($scope.data.DeptID=selected.originalObject.id,$scope.gridData.Dept=selected.originalObject.name)}}initialise(),$scope.view=function(){if("Reset"==$scope.btnName)initialise();else{$scope.result={};var para={};para.DivID=1,para.DeptID=$scope.data.DeptID,para.SDate=$scope.data.SDate,para.EDate=$scope.data.EDate,DataServices.getData("GetAttendance",para,function(response){response.length>0?($scope.disableDept=!0,$scope.content.viewMode=!0,$scope.collection=response,$scope.gridData=response[0],$scope.reportData=[],$scope.reportData.date=getCurrentDate(),$scope.btnName="Reset"):(alert("Data not found"),initialise())})}}}]).controller("AttnDetailsShiftWiseCtrl",["DataServices","$rootScope","$scope","$filter",function(DataServices,$rootScope,$scope,$filter){function initialise(){$scope.data={},$scope.gridData={},$scope.data.SDate="2014-02-01",$scope.data.EDate="2014-02-28",$scope.collectionM=[],$scope.$broadcast("angucomplete-alt:clearInput"),$scope.btnName="View",$scope.disableDept=!1,$scope.content.viewMode=!1,loadDepartments()}function loadDepartments(){$scope.requireDept=!0,$scope.deptName={},DataServices.SelectData("Dept","name",function(response){$scope.deptName=response}),$scope.selectedDept=function(selected){selected&&($scope.data.DeptID=selected.originalObject.id,$scope.gridData.Dept=selected.originalObject.name)}}initialise(),$scope.view=function(){if("Reset"==$scope.btnName)initialise();else{$scope.result={};var para={};para.DivID=1,para.DeptID=$scope.data.DeptID,para.SDate=$scope.data.SDate,para.EDate=$scope.data.EDate,DataServices.getData("GetAttendance",para,function(response){if(response.length>0){$scope.content.viewMode=!0,$scope.disableDept=!0,$scope.btnName="Reset",$scope.gridData=response[0],$scope.collection=response,$scope.reportData=[],$scope.reportData.date=getCurrentDate(),$scope.collectionM=[{id:"1",M_value:""},{id:"2",M_value:""},{id:"3",M_value:""},{id:"4",M_value:""},{id:"5",M_value:""},{id:"6",M_value:""},{id:"7",M_value:""},{id:"8",M_value:""},{id:"9",M_value:""},{id:"10",M_value:""},{id:"11",M_value:""},{id:"12",M_value:""},{id:"13",M_value:""},{id:"14",M_value:""},{id:"15",M_value:""},{id:"16",M_value:""},{id:"17",M_value:""},{id:"18",M_value:""},{id:"19",M_value:""},{id:"20",M_value:""},{id:"21",M_value:""},{id:"22",M_value:""},{id:"23",M_value:""},{id:"24",M_value:""},{id:"25",M_value:""},{id:"26",M_value:""},{id:"27",M_value:""},{id:"28",M_value:""},{id:"29",M_value:""},{id:"30",M_value:""}];for(var i=0;i<$scope.collection.length;i++)"P"!=$scope.collection[i].Status&&($scope.collectionM[i].M_value="M")}else alert("Data not found"),initialise()})}}}]).controller("PfChallanCtrl",["DataServices","$rootScope","$scope",function(DataServices,$rootScope,$scope){function initialise(){$scope.data={},$scope.data.DivId=1,$scope.gridData={},$scope.collection=[],$scope.btnName="View",$scope.content.viewMode=!1,loadMonths(),loadYears()}function loadMonths(){$scope.months=[{id:"0",name:"(Select)"},{id:"1",name:"January"},{id:"2",name:"February"},{id:"3",name:"March"},{id:"4",name:"April"},{id:"5",name:"May"},{id:"6",name:"June"},{id:"7",name:"July"},{id:"8",name:"August"},{id:"9",name:"September"},{id:"10",name:"October"},{id:"11",name:"November"},{id:"12",name:"December"}],$scope.selectedMonth=$scope.months[0],$scope.selectMonth=function(selectedMonth){$scope.month=selectedMonth.id}}function loadYears(){var yr=(new Date).getFullYear();$scope.years=[{id:"0",name:"(Select)"},{id:"1",name:yr-5},{id:"2",name:yr-4},{id:"3",name:yr-3},{id:"4",name:yr-2},{id:"5",name:yr-1},{id:"6",name:yr},{id:"7",name:yr+1},{id:"8",name:yr+2}],$scope.selectedYear=$scope.years[0],$scope.selectYear=function(selectedYear){$scope.year=selectedYear.name}}initialise(),$scope.view=function(){if("Reset"==$scope.btnName)initialise();else{var para={DivId:$scope.data.DivId,month:$scope.month,year:$scope.year};DataServices.getData("GetPFChallan",para,function(response){response.length>0?($scope.gridData=response[0],$scope.reportData=[],$scope.reportData.date=getCurrentDate(),$scope.content.viewMode=!0,$scope.btnName="Reset"):(alert("Data not found"),initialise())})}}}]).controller("PtChallanCtrl",["DataServices","$rootScope","$scope",function(DataServices,$rootScope,$scope){function initialise(){$scope.data={},$scope.data.DivId=1,$scope.gridData={},$scope.collection=[],$scope.btnName="View",$scope.content.viewMode=!1,loadMonths(),loadYears()}function loadMonths(){$scope.months=[{id:"0",name:"(Select)"},{id:"1",name:"January"},{id:"2",name:"February"},{id:"3",name:"March"},{id:"4",name:"April"},{id:"5",name:"May"},{id:"6",name:"June"},{id:"7",name:"July"},{id:"8",name:"August"},{id:"9",name:"September"},{id:"10",name:"October"},{id:"11",name:"November"},{id:"12",name:"December"}],$scope.selectedMonth=$scope.months[0],$scope.selectMonth=function(selectedMonth){$scope.month=selectedMonth.id}}function loadYears(){var yr=(new Date).getFullYear();$scope.years=[{id:"0",name:"(Select)"},{id:"1",name:yr-5},{id:"2",name:yr-4},{id:"3",name:yr-3},{id:"4",name:yr-2},{id:"5",name:yr-1},{id:"6",name:yr},{id:"7",name:yr+1},{id:"8",name:yr+2}],$scope.selectedYear=$scope.years[0],$scope.selectYear=function(selectedYear){$scope.year=selectedYear.name}}initialise(),$scope.report=[{companyName:"Juliet Apparels ltd.",companyAddress:"313, Shah & Nahar ind. Estate, S.J. Marg, Lower Parel,, Mumbai - 400013, Maharashtra"}],$scope.view=function(){if("Reset"==$scope.btnName)initialise();else{var para={DivId:$scope.data.DivId,month:$scope.month,year:$scope.year};DataServices.getData("getPTChallan",para,function(response){$scope.selectedMonth!=$scope.months[0]&&$scope.selectedYear!=$scope.years[0]&&response.length>0?($scope.gridData=response[0],$scope.content.viewMode=!0,$scope.btnName="Reset",$scope.reportData=[],$scope.reportData.date=getCurrentDate()):(alert("Data not found"),initialise())})}}}]).controller("BonusRegisterCtrl",["DataServices","$rootScope","$scope",function(DataServices,$rootScope,$scope){function initialise(){$scope.data={},$scope.gridData={},$scope.data.DivId=1,$scope.data.SDate="2013-01-01",$scope.data.EDate="2013-01-24",$scope.btnName="View",$scope.content.viewMode=!0,$scope.reportData=[],$scope.reportData.date=getCurrentDate(),loadDepartments()}function loadDepartments(){$scope.requireDept=!0,$scope.deptName={},DataServices.SelectData("Dept","name",function(response){$scope.deptName=response}),$scope.selectedDept=function(selected){selected&&($scope.data.DeptId=selected.originalObject.id,$scope.gridData.Dept=selected.originalObject.name)}}initialise(),$scope.view=function(){if("Reset"==$scope.btnName)initialise();else{$scope.result={};var para={};para.divID=$scope.data.divID,para.DeptId=$scope.data.DeptId,para.SDate=$scope.data.SDate,para.EDate=$scope.data.EDate,DataServices.getData("getBonusRegister",para,function(response){response.length>0?($scope.gridData=response[0],$scope.collection=response,$scope.reportData=[],$scope.reportData.date=getCurrentDate(),$scope.content.viewMode=!0,$scope.btnName="Reset"):(alert("Data not found"),initialise())})}}}]).controller("Form16Ctrl",["$rootScope","$scope","$http",function($rootScope,$scope,$http,$filter){$scope.data={},$scope.data.DivId=1,$scope.requireEmp=!0,$scope.empName={},$http.post($rootScope.POSTRequestURL,{requestName:$rootScope.globals.currentDB.dbName+".dbo.getSelectData",values:"Employees, firstName"}).then(function(data){$scope.empName=angular.fromJson(data.data)},function(err){alert(JSON.stringify(err))}),$scope.selectedEmp=function(selected){selected&&($scope.data.EmpID=selected.originalObject.id)},function(){var yr=(new Date).getFullYear();$scope.years=[{id:"0",name:"(Select)"},{id:"1",name:yr-3},{id:"2",name:yr-2},{id:"3",name:yr-1},{id:"4",name:yr},{id:"5",name:yr+1},{id:"6",name:yr+2}],$scope.selectedFromYear=$scope.years[0],$scope.selectedToYear=$scope.years[0],$scope.selectFromYear=function(selectedFromYear){$scope.fromYear=selectedFromYear.name},$scope.selectToYear=function(selectedToYear){$scope.toYear=selectedToYear.name}}(),$scope.view=function(){$http.post($rootScope.POSTRequestURL,{requestName:$rootScope.globals.currentDB.dbName+".dbo.getForm16",values:$scope.data.DivId+","+$scope.data.EmpID+","+$scope.fromYear+","+$scope.toYear}).then(function(data){},function(err){alert(JSON.stringify(err))})}}]).controller("Form3ACtrl",["DataServices","$rootScope","$scope",function(DataServices,$rootScope,$scope){function initialise(){$scope.data={},$scope.total={},$scope.data.DivId=1,$scope.data.SDate="2011-05-01",$scope.data.EDate="2011-05-31",$scope.collection=[],$scope.content.viewMode=!1,$scope.btnName="View"}initialise(),$scope.report=[{companyName:"Juliet Apparels ltd.",companyAddress:"313, Shah & Nahar ind. Estate, S.J. Marg, Lower Parel,, Mumbai - 400013, Maharashtra"}];var rpt=[];rpt=angular.fromJson($scope.report),$scope.report.companyName=rpt[0].companyName,$scope.report.companyAddress=rpt[0].companyAddress,$scope.view=function(){if("Reset"==$scope.btnName)initialise();else{$scope.result={};var para={};para.divID=$scope.data.DivId,para.SDate=$scope.data.SDate,para.EDate=$scope.data.EDate,DataServices.getData("GetForm3A",para,function(response){response.length>0?($scope.collection=response,$scope.gridData=response[0],$scope.content.viewMode=!0,$scope.btnName="Reset"):(alert("Data not found"),initialise())})}},$scope.reset=function(){initialise()}}]).controller("Form6ACtrl",["DataServices","$rootScope","$scope",function(DataServices,$rootScope,$scope){function initialise(){$scope.data={},$scope.total={},$scope.data.DivId=1,$scope.data.SDate="2011-05-01",$scope.data.EDate="2011-05-31",$scope.collection=[],$scope.content.viewMode=!1,$scope.btnName="View"}initialise(),$scope.report=[{companyName:"Juliet Apparels ltd.",companyAddress:"313, Shah & Nahar ind. Estate, S.J. Marg, Lower Parel,, Mumbai - 400013, Maharashtra"}];var rpt=[];rpt=angular.fromJson($scope.report),$scope.report.companyName=rpt[0].companyName,$scope.report.companyAddress=rpt[0].companyAddress,$scope.view=function(){if("Reset"==$scope.btnName)initialise();else{$scope.result={};var para={};para.divID=$scope.data.DivId,para.SDate=$scope.data.SDate,para.EDate=$scope.data.EDate,DataServices.getData("GetForm6A",para,function(response){response.length>0?($scope.collection=response,$scope.content.viewMode=!0,$scope.btnName="Reset"):(alert("Data not found"),initialise())})}},$scope.reset=function(){initialise()}}]).controller("LoanRequestCtrl",["DataServices","$rootScope","$scope","$filter",function(DataServices,$rootScope,$scope,$filter){function initialize(){$scope.data={},$scope.total={},$scope.collection=[],$scope.result={},$scope.content.viewMode=!1,$scope.btnName="View",$scope.total.Opg=0,$scope.total.Advance=0,$scope.total.Deduction=0,$scope.total.OutSideLoanPaid=0,$scope.total.Closing=0,loadMonths(),loadYears()}function loadMonths(){var dm=(new Date).getMonth();$scope.months=[{id:"1",name:"January"},{id:"2",name:"February"},{id:"3",name:"March"},{id:"4",name:"April"},{id:"5",name:"May"},{id:"6",name:"June"},{id:"7",name:"July"},{id:"8",name:"August"},{id:"9",name:"September"},{id:"10",name:"October"},{id:"11",name:"November"},{id:"12",name:"December"}],$scope.selectedMonth=$scope.months[dm],$scope.data.month=$scope.months[dm].id,$scope.selectMonth=function(selectedMonth){$scope.data.month=selectedMonth.id}}function loadYears(){var yr=(new Date).getFullYear();$scope.years=[{id:"1",name:yr-3},{id:"2",name:yr-2},{id:"3",name:yr-1},{id:"4",name:yr},{id:"5",name:yr+1},{id:"6",name:yr+2}],$scope.selectedYear=$scope.years[3],$scope.data.year=$scope.years[3].name,$scope.selectYear=function(selectedYear){$scope.data.year=selectedYear.name}}initialize(),$scope.report=[{companyName:"Juliet Apparels ltd.",companyAddress:"313, Shah & Nahar ind. Estate, S.J. Marg, Lower Parel,, Mumbai - 400013, Maharashtra"}];var rpt=[];rpt=angular.fromJson($scope.report),$scope.report.companyName=rpt[0].companyName,$scope.report.companyAddress=rpt[0].companyAddress,"Advance Request Information"==$scope.currentModule?$scope.rptTitle="Advance Request Form":"Deduction Request Information"==$scope.currentModule?$scope.rptTitle="Deduction Request Form":$scope.rptTitle="Loan & Advance Register",$scope.view=function(){if("Reset"==$scope.btnName)initialize();else{var para={DivID:1,month:$scope.data.month,year:$scope.data.year};DataServices.getData("GetloanInfo",para,function(response){if($scope.collection=response,$scope.collection.length>0){$scope.btnName="Reset",$scope.reportData=[],$scope.reportData.date=getCurrentDate(),$scope.content.viewMode=!0;for(var i=0;i<$scope.collection.length;i++)$scope.total.Opg=$scope.total.Opg+$scope.collection[i].Opg,$scope.total.Advance=$scope.total.Advance+$scope.collection[i].Advance,$scope.total.Deduction=$scope.total.Deduction+$scope.collection[i].Deduction,$scope.total.OutSideLoanPaid=$scope.total.OutSideLoanPaid+$scope.collection[i].OutSideLoanPaid,$scope.total.Closing=$scope.total.Closing+$scope.collection[i].Closing}else alert("No record found!!!"),initialize()})}}}]).controller("PaySlipCtrl",["DataServices","$rootScope","$scope",function(DataServices,$rootScope,$scope){$scope.btnName="Search";var dt=new Date,yr=dt.getFullYear(),mt=dt.getMonth();$scope.months=[{id:"0",name:"January"},{id:"1",name:"February"},{id:"2",name:"March"},{id:"3",name:"April"},{id:"4",name:"May"},{id:"5",name:"June"},{id:"6",name:"July"},{id:"7",name:"August"},{id:"8",name:"September"},{id:"9",name:"October"},{id:"10",name:"November"},{id:"11",name:"December"}],$scope.selectedMonth=$scope.months[mt],$scope.selectMonth=function(selectedMonth){$scope.month=selectedMonth.id},$scope.years=[{id:"1",name:yr-3},{id:"2",name:yr-2},{id:"3",name:yr-1},{id:"4",name:yr}],$scope.selectedYear=$scope.years[3],$scope.selectYear=function(selectedYear){$scope.year=selectedYear.name},DataServices.SelectData("dept","name",function(response){$scope.departments=response,$scope.selectedDepartment=$scope.departments[0],$scope.selectDepartment=function(selected){$scope.data.deptID=selected.id}}),DataServices.SelectData("Employees","name",function(response){$scope.employees=response}),$scope.selectedEmp=function(selected){selected&&($scope.data.EmpID=selected.originalObject.id)}}])}(),function(){"use strict";angular.module("Payroll").controller("AttnTransCtrl",["DataServices","$rootScope","$scope",function(DataServices,$rootScope,$scope){$scope.data={ID:0},$scope.viewMode=!1,DataServices.SelectData("Employees","firstName",function(response){$scope.employees=response,$scope.selectedEmp=function(selected){selected&&($scope.data.empID=selected.originalObject.id)}}),DataServices.SelectData("Shifts","code",function(response){$scope.shifts=response,$scope.selectedShift=$scope.shifts[0],$scope.selectShift=function(selectedShift){$scope.data.shiftID=selectedShift.name}}),$scope.months=[{id:"0",name:"(Select)"},{id:"1",name:"January"},{id:"2",name:"February"},{id:"3",name:"March"},{id:"4",name:"April"},{id:"5",name:"May"},{id:"6",name:"June"},{id:"7",name:"July"},{id:"8",name:"August"},{id:"9",name:"September"},{id:"10",name:"October"},{id:"11",name:"November"},{id:"12",name:"December"}],$scope.selectedMonth=$scope.months[0],$scope.selectMonth=function(selectedMonth){$scope.month=selectedMonth.id};var yr=(new Date).getFullYear();$scope.years=[{id:"0",name:"(Select)"},{id:"1",name:yr-3},{id:"2",name:yr-2},{id:"3",name:yr-1},{id:"4",name:yr},{id:"5",name:yr+1},{id:"6",name:yr+2}],$scope.selectedYear=$scope.years[0],$scope.selectYear=function(selectedYear){$scope.year=selectedYear.name},$scope.setEditMode=function(value){$scope.editMode=value},$scope.view=function(){var para={empID:$scope.data.empID,shiftID:$scope.data.shiftID,month:$scope.month,year:$scope.year};DataServices.getData("getAttnTransData",para,function(response){$scope.attns=response,""==$scope.attns&&($scope.viewMode=!0)})},$scope.setStatus=function(status){$scope.data.NoOfDays=30;var para={EmpId:$scope.data.empID,Month:$scope.month,Year:$scope.year,NoOfDays:$scope.data.NoOfDays,Shift:$scope.data.shiftID,Status:status};"X"==status&&(document.getElementById("Present").disabled=!0,document.getElementById("Absent").disabled=!0),"P"==status&&(document.getElementById("Schedule").disabled=!0,document.getElementById("Absent").disabled=!0),"A"==status&&(document.getElementById("Schedule").disabled=!0,document.getElementById("Present").disabled=!0),DataServices.Submit("InsertAttn",para,function(response){$scope.result=response,$scope.view()})},$scope.edit=function(id){$scope.result={},DataServices.Edit("AttnTrans",id,function(response){$scope.attn=response})},$scope.save=function(para){para={ID:para.ID,status:para.status},DataServices.Submit("doAttnTrans",para,function(response){$scope.result=response,$scope.view()})},$scope.reset=function(){$scope.selectedShift=$scope.shifts[0],$scope.selectedMonth=$scope.months[0],$scope.selectedYear=$scope.years[0],$scope.attns={},$scope.$broadcast("angucomplete-alt:clearInput"),document.getElementById("Schedule").disabled=!1,document.getElementById("Present").disabled=!1,document.getElementById("Absent").disabled=!1}}]).controller("SalCtrl",["DataServices","$rootScope","$scope",function(DataServices,$rootScope,$scope){$scope.data={},$scope.btnName="View",DataServices.SelectData("divisions","Name",function(response){$scope.divisions=response,$scope.selectedDiv=function(selected){selected&&($scope.data.divID=selected.originalObject.id)}});var dt=new Date,dm=dt.getMonth();$scope.months=[{id:"1",name:"January"},{id:"2",name:"February"},{id:"3",name:"March"},{id:"4",name:"April"},{id:"5",name:"May"},{id:"6",name:"June"},{id:"7",name:"July"},{id:"8",name:"August"},{id:"9",name:"September"},{id:"10",name:"October"},{id:"11",name:"November"},{id:"12",name:"December"}],$scope.selectedMonth=$scope.months[dm],$scope.data.month=$scope.months[dm].id,$scope.selectMonth=function(selectedMonth){$scope.data.month=selectedMonth.id};var dy=dt.getFullYear();$scope.years=[{name:dy},{name:dy-2},{name:dy-1},{name:dy+1},{name:dy+2}],$scope.selectedYear=$scope.years[0],$scope.data.year=$scope.years[0].name,$scope.selectYear=function(selectedYear){$scope.data.year=selectedYear.name},$scope.view=function(){var para={tblName:$scope.contents[$rootScope.currentModuleId].tblName,divID:$scope.data.divID,month:$scope.data.month,year:$scope.data.year};DataServices.getData("getSalTransData",para,function(response){$scope.salaries=response})},$scope.bindForm=function(){"Reset"==$scope.btnName?($scope.$broadcast("angucomplete-alt:clearInput","Divisions"),$scope.salaries={},$scope.selectedMonth=$scope.months[dm],$scope.selectedYear=$scope.years[0],$scope.btnName="View"):($scope.view(),$scope.btnName="Reset")},$scope.deleteSal=function(){$scope.result={};var para={divID:$scope.data.divID,month:$scope.data.month,year:$scope.data.year};DataServices.Submit("deleteSalary",para,function(response){$scope.result=response,$scope.bindForm()})}}]).controller("PfDataCtrl",["DataServices","$rootScope","$scope",function(DataServices,$rootScope,$scope){$scope.data={ID:0},$scope.btnName="View",DataServices.SelectData("Employees","firstName",function(response){$scope.employees=response,$scope.selectedEmp=function(selected){selected&&($scope.data.empID=selected.originalObject.id)}}),$scope.months=[{id:"0",name:"(Select)"},{id:"1",name:"January"},{id:"2",name:"February"},{id:"3",name:"March"},{id:"4",name:"April"},{id:"5",name:"May"},{id:"6",name:"June"},{id:"7",name:"July"},{id:"8",name:"August"},{id:"9",name:"September"},{id:"10",name:"October"},{id:"11",name:"November"},{id:"12",name:"December"}],$scope.selectedMonth=$scope.months[0],$scope.selectMonth=function(selectedMonth){$scope.month=selectedMonth.id};var yr=(new Date).getFullYear();$scope.years=[{id:"0",name:"(Select)"},{id:"1",name:yr-5},{id:"2",name:yr-4},{id:"3",name:yr-3},{id:"4",name:yr-2},{id:"5",name:yr-1},{id:"6",name:yr},{id:"7",name:yr+1},{id:"8",name:yr+2}],$scope.selectedYear=$scope.years[0],$scope.selectYear=function(selectedYear){$scope.year=selectedYear.name},$scope.view=function(){if("Reset"==$scope.btnName)$scope.pftrans=[],$scope.result={},$scope.selectedMonth=$scope.months[0],$scope.selectedYear=$scope.years[0],$scope.btnName="View";else{var para={divID:1,month:$scope.month,year:$scope.year};DataServices.getData("getPFdata",para,function(response){$scope.pftrans=response}),$scope.btnName="Reset"}},$scope.save=function(para){para={ID:para.ID,divID:1,empID:para.empID,month:$scope.month,year:$scope.year,gross:para.gross,pf:para.pf,epfDiff:para.epfDiff,pfContro:para.pfContro},DataServices.Submit("doPFTrans",para,function(response){$scope.result=response,$scope.btnName="View",$scope.view(),$scope.data={ID:0},$scope.$broadcast("angucomplete-alt:clearInput")})},$scope.setEditMode=function(value){$scope.editMode=value}}]).controller("EsicDataCtrl",["DataServices","$rootScope","$scope",function(DataServices,$rootScope,$scope){$scope.data={ID:0},$scope.btnName="View",DataServices.SelectData("Employees","firstName",function(response){$scope.employees=response,$scope.selectedEmployee=function(selected){selected&&($scope.data.empID=selected.originalObject.id)}});var dt=new Date,dm=dt.getMonth();$scope.months=[{id:"1",name:"January"},{id:"2",name:"February"},{id:"3",name:"March"},{id:"4",name:"April"},{id:"5",name:"May"},{id:"6",name:"June"},{id:"7",name:"July"},{id:"8",name:"August"},{id:"9",name:"September"},{id:"10",name:"October"},{id:"11",name:"November"},{id:"12",name:"December"}],$scope.selectedMonth=$scope.months[dm],$scope.data.month=$scope.months[dm].id,$scope.selectMonth=function(selectedMonth){$scope.data.month=selectedMonth.id};var dy=dt.getFullYear();$scope.years=[{name:dy},{name:dy-2},{name:dy-1},{name:dy+1},{name:dy+2}],$scope.selectedYear=$scope.years[0],$scope.data.year=$scope.years[0].name,$scope.selectYear=function(selectedYear){$scope.data.year=selectedYear.name},$scope.setEditMode=function(value){$scope.editMode=value},$scope.save=function(para){para={ID:para.ID,divID:1,empID:para.empID,month:$scope.data.month,year:$scope.data.year,gross:para.gross,esicAmt:para.esicAmt,employeesContribution:para.employeesContribution,employerContribution:para.employerContribution},DataServices.Submit("doESICTrans",para,function(response){$scope.result=response,$scope.btnName="View",$scope.view(),$scope.data={ID:0}})},$scope.view=function(){if("Reset"==$scope.btnName)$scope.esic=[],$scope.selectedMonth=$scope.months[dm],$scope.selectedYear=$scope.years[0],$scope.btnName="View";else{var para={divID:1,month:$scope.data.month,year:$scope.data.year};DataServices.getData("getESICData",para,function(response){$scope.esicTrans=response,$scope.btnName="Reset"})}}}]).controller("LoanCtrl",["DataServices","$scope","$filter",function(DataServices,$scope,$filter){function bindLoanTransGrid(){var para={tblName:"LoanTrans",ID:0,loanID:$scope.data.loanID};DataServices.getData("getTransSearchData",para,function(response){$scope.loans=response;for(var i=0;i<$scope.loans.length;i++)addAmt+=$scope.loans[i].addAmt,lessAmt+=$scope.loans[i].lessAmt,outSidePaid+=$scope.loans[i].outSidePaid;$scope.balAmt=addAmt-(lessAmt+outSidePaid)})}function saveGrid(){if($scope.loans!={})for(var i=0;i<$scope.loans.length;i++)$scope.loans=[{ID:$scope.loans[i].ID,loanID:$scope.data.loanID,empID:$scope.data.empID,deductDt:$scope.loans[i].deductDt,addAmt:$scope.loans[i].addAmt,lessAmt:$scope.loans[i].lessAmt,outSidePaid:$scope.loans[i].outSidePaid,loanAdv:$scope.loans[i].loanAdv}],DataServices.Submit("doLoanDeduct",$scope.loans[i],function(response){$scope.result=response,bindLoanTransGrid()})}$scope.data={ID:0,loanID:"",loanDt:"",empID:"",method:"",loanAmt:void 0,loanInt:void 0,totAmt:void 0,totMonth:void 0,deduct:void 0},$scope.txtgrid={ID:0},$scope.loans=[];var addAmt=0,lessAmt=0,outSidePaid=0;DataServices.SelectData("Employees","firstName",function(response){$scope.employees=response}),$scope.selectedEmp=function(selected){selected&&($scope.data.empID=selected.originalObject.id,$scope.selectedEmpName=selected.originalObject.name)},$scope.addToGrid=function(grid){null==$scope.txtgrid.deductDt?$scope.result.error="Please fill deduct Dt":($scope.loans.push(grid),addAmt+=$scope.txtgrid.addAmt,lessAmt+=$scope.txtgrid.lessAmt,outSidePaid+=$scope.txtgrid.outSidePaid,$scope.balAmt=addAmt-(lessAmt+outSidePaid),$scope.txtgrid={})},$scope.remove=function(grid){$scope.result={};var index=$scope.loans.indexOf(grid);if(""!=index)$scope.loans.splice(index,1);else{var para={tblName:"LoanTrans",ID:grid.ID,LoanID:0};DataServices.Submit("getTransSearchData",para,function(response){$scope.result=response,bindLoanTransGrid(),$scope.result={}})}},$scope.submit=function(){$scope.result={},DataServices.Submit("doLoan",$scope.data,function(response){$scope.result=response,void 0==$scope.result.error?saveGrid():$scope.result.error="Loan Details are not saved.."})},$scope.saveRows=function(id){$scope.result={},$scope.loan={ID:id,loanID:$scope.data.loanID,empID:$scope.data.empID,deductDt:$scope.loan.deductDt,addAmt:$scope.loan.addAmt,lessAmt:$scope.loan.lessAmt,outSidePaid:$scope.loan.outSidePaid,loanAdv:$scope.loan.loanAdv},DataServices.Submit("doLoanDeduct",$scope.loan,function(response){$scope.result=response,bindLoanTransGrid(),$scope.result={}})},$scope.edit=function(id){$scope.result={},DataServices.Edit("Loans",id,function(response){$scope.data=response,bindLoanTransGrid(),$scope.$broadcast("angucomplete-alt:changeInput","Employee",$filter("filter")($scope.employees,{id:$scope.data.empID},!0)[0])})},$scope.reset=function(){$scope.data={ID:0,loanID:"",loanDt:"",empID:"",method:"",loanAmt:void 0,loanInt:void 0,totAmt:void 0,totMonth:void 0,deduct:void 0},$scope.txtgrid={ID:0},$scope.loans=[],$scope.$broadcast("angucomplete-alt:clearInput","Employee"),$scope.balAmt=""}}]).controller("LoanDeductCtrl",["DataServices","$rootScope","$scope",function(DataServices,$rootScope,$scope){$scope.data={},$scope.btnName="View",DataServices.SelectData("Divisions","Name",function(response){$scope.divisionName=response}),$scope.selectedDivision=function(selected){selected&&($scope.data.divID=selected.originalObject.id)};var dt=new Date,dm=dt.getMonth();$scope.months=[{id:"1",name:"January"},{id:"2",name:"February"},{id:"3",name:"March"},{id:"4",name:"April"},{id:"5",name:"May"},{id:"6",name:"June"},{id:"7",name:"July"},{id:"8",name:"August"},{id:"9",name:"September"},{id:"10",name:"October"},{id:"11",name:"November"},{id:"12",name:"December"}],$scope.selectedMonth=$scope.months[dm],$scope.data.month=$scope.months[dm].id,$scope.selectMonth=function(selectedMonth){$scope.data.month=selectedMonth.id};var dy=dt.getFullYear();$scope.years=[{name:dy},{name:dy-2},{name:dy-1},{name:dy+1},{name:dy+2}],$scope.selectedYear=$scope.years[0],$scope.data.year=$scope.years[0].name,$scope.selectYear=function(selectedYear){$scope.data.year=selectedYear.name},$scope.bindGrid=function(){"Reset"==$scope.btnName?($scope.data={},$scope.loans={},$scope.$broadcast("angucomplete-alt:clearInput"),$scope.btnName="View",$scope.selectedMonth=$scope.months[dm],$scope.selectedYear=$scope.years[0]):($scope.btnName="Reset",$scope.data={divID:$scope.data.divID,month:$scope.data.month,year:$scope.data.year},DataServices.getData("getLoanDeductData",$scope.data,function(response){$scope.loans=response}))},$scope.save=function(para){para={ID:para.ID,loanID:"",empID:"",deductDt:"",addAmt:0,lessAmt:para.lessAmt,outSidePaid:para.outSidePaid,loanAdv:"D"},DataServices.Submit("doLoanDeduct",para,function(response){$scope.result=response,$scope.btnName="View",$scope.bindGrid()})}}]).controller("ItCtrl",["DataServices","$scope",function(DataServices,$scope){function calc10(){for(var grid80C=0,i=0;i<$scope.IT80Cs.length;i++)grid80C+=$scope.IT80Cs[i].amount;for(i=0;i<$scope.IT80Es.length;i++)grid80C+=$scope.IT80Es[i].amount;$scope.data.chapter6ATot=($scope.data.it80CCC+$scope.data.it80CCD+grid80C+0)/4}function getIncomeTax(){var para={fromYear:$scope.data.fromYear,toyear:$scope.data.toYear,gender:$scope.gender};DataServices.getData("getITYears",para,function(response){$scope.IncomeTax=response;for(var i=0;i<response.length;i++)response[i].fromAmt<=$scope.data.totIncome&&response[i].toAmt>=$scope.data.totIncome&&($scope.data.totIncomeTax=$scope.data.totIncome*response[i].taxPer/100)})}function saveGrids(){if($scope.allowances!={})for(i=0;i<$scope.allowances.length;i++){var cl={tblName:"ITAllowance",ID:$scope.allowances[i].ID,name:$scope.allowances[i].name,amount:$scope.allowances[i].amount,qualify:"0"};DataServices.Submit("doITAddDeduct",cl,function(response){$scope.result=response}),cl={}}if($scope.otherIncomes!={})for(i=0;i<$scope.otherIncomes.length;i++){var ca={tblName:"ITOtherIncome",ID:$scope.otherIncomes[i].ID,name:$scope.otherIncomes[i].name,amount:$scope.otherIncomes[i].amount,qualify:"0"};DataServices.Submit("doITAddDeduct",ca,function(response){$scope.result=response}),ca={}}if($scope.IT80Cs!={})for(i=0;i<$scope.IT80Cs.length;i++){var c80={tblName:"IT80C",ID:$scope.IT80Cs[i].ID,name:$scope.IT80Cs[i].name,amount:$scope.IT80Cs[i].amount,qualify:"0"};DataServices.Submit("doITAddDeduct",c80,function(response){$scope.result=response}),c80={}}if($scope.IT80Es!={})for(var i=0;i<$scope.IT80Es.length;i++){var e80={tblName:"IT80EG",ID:$scope.IT80Es[i].ID,name:$scope.IT80Es[i].name,amount:$scope.IT80Es[i].amount,qualify:$scope.IT80Es[i].qualifyAmount};DataServices.Submit("doITAddDeduct",e80,function(response){$scope.result=response}),e80={}}}$scope.data={ID:0,divID:1,empID:"",fromYear:0,toYear:0,sec17_1:0,sec17_2:0,sec17_3:0,sec17_Add:0,sec17GrossTot:0,sec17NetTot:0,entAllowance:0,employmentTax:0,stdDeductTot:0,chargeTotIncome:0,grossTotIncome:0,it80CCC:0,it80CCD:0,chapter6ATot:0,totIncome:0,totIncomeTax:0,surcharge:0,eduCess:0,grossTaxPayable:0,releif89:0,netTaxPayable:0,sec192_1:0,sec192_1A:0,totalTax:0},$scope.btnName="View",$scope.allowances=[],$scope.otherIncomes=[],$scope.IT80Cs=[],$scope.IT80Es=[],DataServices.SelectData("Employees","Name",function(response){$scope.employees=response,$scope.selectedEmployee=function(selected){selected&&($scope.data.empID=selected.originalObject.id,$scope.empName=selected.originalObject.name,$scope.gender=selected.originalObject.gender)}});var dy=(new Date).getFullYear();$scope.years=[{name:dy-2},{name:dy-1},{name:dy},{name:dy+1},{name:dy+2}],$scope.selectedFromYear=$scope.years[1],$scope.selectedToYear=$scope.years[2],$scope.data.fromYear=$scope.years[1].name,$scope.data.toYear=$scope.years[2].name,$scope.selectFromYear=function(selectedFromYear){$scope.data.fromYear=selectedFromYear.name},$scope.selectToYear=function(selectedToYear){$scope.data.toYear=selectedToYear.name},$scope.calculateOnChange=function(){$scope.data.sec17GrossTot=$scope.data.sec17_1+$scope.data.sec17_Add+$scope.data.sec17_2+$scope.data.sec17_3},$scope.$watch("[data.sec17_1 , data.sec17_Add, data.sec17_2, data.sec17_3,data.sec17GrossTot, data.entAllowance ,                     data.employmentTax,data.sec17NetTot, data.stdDeductTot,data.chargeTotIncome, data.it80CCC, data.it80CCD,data.grossTotIncome, data.chapter6ATot,                     data.totIncome, data.totIncomeTax, data.surcharge, data.eduCess,                    data.grossTaxPayable, data.releif89, data.sec192_1, data.sec192_1A, data.netTaxPayable]",function(){for(var less=0,i=0;i<$scope.allowances.length;i++)less+=$scope.allowances[i].amount;$scope.data.sec17NetTot=$scope.data.sec17GrossTot-less,$scope.data.stdDeductTot=($scope.data.entAllowance+$scope.data.employmentTax)/2,$scope.data.chargeTotIncome=$scope.data.sec17NetTot-$scope.data.stdDeductTot;for(var add=0,i=0;i<$scope.otherIncomes.length;i++)add+=$scope.otherIncomes[i].amount;$scope.data.grossTotIncome=$scope.data.chargeTotIncome+add,calc10(),$scope.data.totIncome=$scope.data.grossTotIncome-$scope.data.chapter6ATot,1==$scope.viewForm&&getIncomeTax(),$scope.data.grossTaxPayable=$scope.data.totIncomeTax+$scope.data.surcharge+$scope.data.eduCess,$scope.data.netTaxPayable=$scope.data.grossTaxPayable-$scope.data.releif89,$scope.data.totalTax=$scope.data.netTaxPayable-($scope.data.sec192_1+$scope.data.sec192_1A)}),$scope.addAllowance=function(grid){null==$scope.allowanceData.amount||null==$scope.allowanceData.name?$scope.result.error="please fill textbox":(grid={ID:0,name:grid.name,amount:grid.amount},$scope.allowances.push(grid),$scope.data.sec17NetTot=$scope.data.grossTotIncome-grid.amount,$scope.allowanceData={},$scope.result={})},$scope.removeAllowance=function(grid){$scope.data.sec17NetTot=$scope.data.sec17NetTot+grid.amount,$scope.allowances.splice(grid,1)},$scope.addOtherIncome=function(grid){null==$scope.otherIncomeData.name||null==$scope.otherIncomeData.amount?$scope.result.error="please fill Addtional income Name and Amount":(grid={ID:0,name:grid.name,amount:grid.amount},$scope.otherIncomes.push(grid),$scope.data.grossTotIncome=$scope.data.grossTotIncome+grid.amount,$scope.otherIncomeData={},$scope.result={})},$scope.removeOtherIncome=function(grid){$scope.data.grossTotIncome=$scope.data.grossTotIncome-grid.amount,$scope.otherIncomes.splice(grid,1)},$scope.addIT80C=function(grid){null==$scope.IT80CData.name||null==$scope.IT80CData.amount?$scope.result.error="please fill 80C Name and Amount":(grid={ID:0,name:grid.name,amount:grid.amount},$scope.IT80Cs.push(grid),$scope.IT80CData={},$scope.result={},calc10())},$scope.removeIT80C=function(grid){$scope.IT80Cs.splice(grid,1),calc10()},$scope.addIT80E=function(grid){null==$scope.IT80EData.name||null==$scope.IT80EData.amount||null==$scope.IT80EData.qualifyAmount?$scope.result.error="please fill 80E Name and Amount":($scope.IT80Es.push(grid),$scope.IT80EData={},$scope.result={},calc10())},$scope.removeIT80E=function(grid){$scope.IT80Es.splice(grid,1),calc10()},$scope.bindForm=function(){"Reset"==$scope.btnName?$scope.reset():($scope.btnName="Reset",$scope.salary={empID:$scope.data.empID,fromYear:$scope.data.fromYear,toYear:$scope.data.toYear},DataServices.getData("getSalary",$scope.salary,function(netSalary){""!=netSalary?($scope.data.sec17_1=netSalary[0].net,$scope.viewForm=!0):$scope.result={error1:"Salary not exists"}}))},$scope.submit=function(){$scope.result={},DataServices.Submit("doITTrans",$scope.data,function(response){$scope.result=response,void 0==$scope.result.error?saveGrids():$scope.result.error="ITTrans details are not saved.."})},$scope.reset=function(){$scope.btnName="View",$scope.viewForm=!1,$scope.$broadcast("angucomplete-alt:clearInput"),$scope.result={},$scope.selectedFromYear=$scope.years[1],$scope.selectedToYear=$scope.years[2]}}])}();